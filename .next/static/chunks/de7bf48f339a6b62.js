(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";let t,n;var i,l,r,o,s,a,u,p,d,c,h,m,f,g,y,E,_,I,v,T,A,C,S,O,b,N,R,P,x,D,w,M,U,k,L,q,G,j,H,F,V,B,J,Y,W,K,$,z,X,Q,Z,ee,et,en,ei,el,er,eo,es,ea,eu,ep,ed,ec,eh,em,ef,eg,ey,eE,e_,eI,ev,eT,eA,eC,eS,eO,eb,eN,eR,eP,ex,eD,ew,eM,eU,ek,eL,eq,eG,ej,eH,eF,eV,eB,eJ,eY,eW,eK,e$,ez,eX,eQ,eZ,e0,e1,e2,e4,e6,e3,e5,e7=e.i(43476),e8=e.i(71645),e9=e.i(18566),te=e.i(33791),tt=e.i(22016);let tn=[{id:"1",title:"Why I Still Use Vim in 2077",date:"2024-05-12",excerpt:"Modal editing is the future, past, and present. Here is why your mouse is slowing you down.",content:`
      <p>It starts with a simple <code>:q!</code> and ends with you remapping your entire keyboard layout to Colemak-DH.</p>
      <p>Vim is not just a text editor; it is a way of life. When the neural interfaces finally arrive, I bet they will use hjkl for navigation.</p>
      <h3>The Speed</h3>
      <p>Nothing beats the raw speed of text objects. ci" to change inside quotes? Pure magic.</p>
    `,tags:["VIM","PRODUCTIVITY","CLI"]},{id:"2",title:"CSS Grid vs Flexbox: The Final War",date:"2024-04-28",excerpt:"Two titans enter, one titan leaves. Or maybe they just coexist peacefully?",content:`
      <p>We used to float left. We used to clear fixes. Now we have display: grid and display: flex.</p>
      <p>Use Grid for layout, Flex for components. It is that simple. Don't overcomplicate your 2D structures.</p>
    `,tags:["CSS","WEBDEV","FRONTEND"]},{id:"3",title:"Simulating Reality with WebGL",date:"2024-03-15",excerpt:"A deep dive into fragment shaders and how to make your GPU cry.",content:`
      <p>Pixels are just little windows into a mathematical void. With WebGL, we can paint that void.</p>
      <p>Today we explore raymarching signed distance fields (SDFs) to create infinite landscapes in under 4KB of code.</p>
    `,tags:["WEBGL","GRAPHICS","MATH"]}],ti=[{id:"1",name:"NEON_NOTES",description:"A markdown note-taking app that looks like a 1980s terminal but syncs to the cloud.",techStack:["React","Firebase","Tailwind"],link:"#",status:"ONLINE"},{id:"2",name:"SYNTH_WAVE_GEN",description:"AI-powered music generator that creates lo-fi synth tracks for coding.",techStack:["Python","TensorFlow","Audio API"],link:"#",status:"BETA"},{id:"3",name:"VOID_MAIL",description:"A secure, encrypted email client that deletes messages after 24 hours.",techStack:["Node.js","Cryptography","Socket.io"],link:"#",status:"OFFLINE"},{id:"4",name:"RETRO_CAM",description:"Web-based image processor applying dithering and CRT effects to uploaded photos.",techStack:["Canvas API","WASM","Rust"],link:"#",status:"ONLINE"},{id:"5",name:"SHORT_TRANSCRIPT",description:"Automated transcription service for short-form video content (YouTube Shorts, TikTok, Reels) using OpenAI Whisper.",techStack:["Python","Flask","Whisper","Cloud Run"],link:"/transcript",status:"ONLINE"}],tl=()=>(0,e7.jsxs)("div",{className:"space-y-6 max-w-2xl mx-auto",children:[(0,e7.jsxs)("div",{className:"border-b border-red-500/50 pb-2 mb-8 flex justify-between items-end",children:[(0,e7.jsx)("h2",{className:"text-2xl text-black font-vt323 tracking-widest",children:"MEMORY_DUMP"}),(0,e7.jsxs)("span",{className:"text-[10px] font-mono text-gray-500",children:[tn.length," RECORDS"]})]}),(0,e7.jsx)("div",{className:"space-y-4",children:tn.map(e=>(0,e7.jsxs)("div",{className:"group relative pl-3 border-l-2 border-gray-300 hover:border-red-500 transition-colors duration-300 pb-4",children:[(0,e7.jsx)("div",{className:"absolute -left-[5px] top-0 w-2 h-2 bg-white border border-gray-400 group-hover:border-red-500 group-hover:bg-red-500 transition-all"}),(0,e7.jsxs)("div",{className:"flex flex-col gap-1 mb-1",children:[(0,e7.jsxs)("span",{className:"text-red-600 font-mono text-[10px] tracking-widest",children:["[",e.date,"]"]}),(0,e7.jsx)("h3",{className:"text-lg font-bold text-gray-800 group-hover:text-black transition-colors cursor-pointer uppercase leading-tight",children:(0,e7.jsx)(tt.default,{href:`/blog/${e.id}`,className:"hover:underline decoration-red-500 underline-offset-4",children:e.title})})]}),(0,e7.jsx)("p",{className:"text-gray-600 font-mono text-xs max-w-xl leading-relaxed mb-2 line-clamp-2",children:e.excerpt}),(0,e7.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,e7.jsx)(tt.default,{href:`/blog/${e.id}`,className:"text-[10px] text-red-600 underline font-bold tracking-wide",children:"ACCESS_FILE >>"})})]},e.id))})]}),tr=()=>(0,e7.jsxs)("div",{className:"relative z-10 w-full max-w-7xl mx-auto transition-all duration-700",children:[(0,e7.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-[15vw] md:text-[20vw] font-bold text-gray-100 opacity-60 pointer-events-none select-none whitespace-nowrap font-vt323 leading-none z-[-1] blur-sm fixed",children:"MICHELLE"}),(0,e7.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 items-start",children:[(0,e7.jsxs)("div",{className:"text-center md:text-left space-y-6 pt-10 md:pt-20 md:sticky md:top-24",children:[(0,e7.jsxs)("div",{className:"flex items-center justify-center md:justify-start gap-4 text-gray-400 font-mono text-[10px] md:text-xs tracking-[0.5em] animate-pulse",children:[(0,e7.jsx)("span",{children:"⛓"}),(0,e7.jsx)("span",{children:"SYSTEM_OVERRIDE"}),(0,e7.jsx)("span",{children:"⛓"})]}),(0,e7.jsx)("h1",{className:"text-5xl md:text-8xl lg:text-9xl font-bold leading-none tracking-tighter text-black mix-blend-multiply",children:(0,e7.jsx)(te.GlitchText,{text:"MICHELLE_WENG"})}),(0,e7.jsxs)("div",{className:"max-w-xl mx-auto md:mx-0 space-y-4",children:[(0,e7.jsx)("div",{className:"text-sm md:text-lg text-gray-600 font-serif italic tracking-widest",children:"cloud_surfing..."}),(0,e7.jsx)("p",{className:"text-gray-800 font-mono text-xs md:text-sm leading-relaxed text-justify md:text-left border-t border-b border-gray-200 py-4",children:"Michelle Weng. Dwelling in the wired. Constructing maximalist web experiences and efficient backend systems. Obsessed with Y2K aesthetics, clean code, and digital decay."}),(0,e7.jsxs)("div",{className:"flex flex-wrap justify-center md:justify-start gap-2 text-[10px] font-mono text-gray-500 uppercase tracking-wider",children:[(0,e7.jsx)("span",{className:"hover:text-black cursor-crosshair transition-colors",children:"[ React ]"}),(0,e7.jsx)("span",{className:"hover:text-black cursor-crosshair transition-colors",children:"[ Next.js ]"}),(0,e7.jsx)("span",{className:"hover:text-black cursor-crosshair transition-colors",children:"[ TypeScript ]"}),(0,e7.jsx)("span",{className:"hover:text-black cursor-crosshair transition-colors",children:"[ Vim ]"})]})]})]}),(0,e7.jsx)("div",{id:"blog",className:"w-full mt-10 md:mt-0 scroll-mt-24",children:(0,e7.jsx)(tl,{})})]})]}),to=({children:e,title:t,className:n="",borderColor:i="border-gray-800"})=>{let l=i.replace("border-","");return(0,e7.jsxs)("div",{className:`relative bg-white/70 backdrop-blur-sm border ${i} p-6 ${n}`,children:[(0,e7.jsx)("div",{className:`absolute top-0 left-0 w-full h-[1px] bg-${l} opacity-20`}),(0,e7.jsx)("div",{className:`absolute bottom-0 right-0 w-full h-[1px] bg-${l} opacity-20`}),(0,e7.jsx)("div",{className:`absolute -top-[1px] -left-[1px] w-4 h-4 border-l border-t ${i}`}),(0,e7.jsx)("div",{className:`absolute -top-[1px] -right-[1px] w-4 h-4 border-r border-t ${i}`}),(0,e7.jsx)("div",{className:`absolute -bottom-[1px] -left-[1px] w-4 h-4 border-l border-b ${i}`}),(0,e7.jsx)("div",{className:`absolute -bottom-[1px] -right-[1px] w-4 h-4 border-r border-b ${i}`}),t&&(0,e7.jsx)("div",{className:"absolute -top-3 left-6",children:(0,e7.jsx)("span",{className:`bg-white px-2 border-l border-r ${i} text-${l} text-xs tracking-[0.2em] font-bold`,children:t})}),e]})},ts=()=>(0,e7.jsxs)("div",{className:"space-y-12 max-w-6xl mx-auto",children:[(0,e7.jsxs)("div",{className:"border-b border-blue-500/50 pb-2 mb-12 flex justify-between items-end",children:[(0,e7.jsx)("h2",{className:"text-4xl text-black font-vt323 tracking-widest",children:"EXECUTABLES"}),(0,e7.jsx)("span",{className:"text-xs font-mono text-gray-500",children:"DIR: /usr/local/projects"})]}),(0,e7.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:ti.map(e=>(0,e7.jsx)(to,{borderColor:"ONLINE"===e.status?"border-green-700":"BETA"===e.status?"border-yellow-600":"border-red-700",className:"hover:bg-gray-50 transition-colors group",children:(0,e7.jsxs)("div",{className:"flex flex-col h-full justify-between",children:[(0,e7.jsxs)("div",{children:[(0,e7.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,e7.jsx)("h3",{className:"text-xl font-bold text-black font-mono",children:e.name}),(0,e7.jsx)("span",{className:`text-[10px] px-2 py-0.5 border ${"ONLINE"===e.status?"border-green-600 text-green-700":"BETA"===e.status?"border-yellow-600 text-yellow-700":"border-red-600 text-red-700"}`,children:e.status})]}),(0,e7.jsx)("div",{className:"w-full h-1 bg-gray-200 mb-4 overflow-hidden",children:(0,e7.jsx)("div",{className:"h-full bg-gray-400 w-1/3 group-hover:w-full transition-all duration-700 ease-in-out"})}),(0,e7.jsx)("p",{className:"text-gray-600 text-sm font-mono mb-4",children:e.description}),(0,e7.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:e.techStack.map(e=>(0,e7.jsxs)("span",{className:"text-[10px] text-gray-500",children:["[",e,"]"]},e))})]}),(0,e7.jsxs)("a",{href:e.link,className:"w-full border border-dashed border-gray-400 text-gray-500 text-center py-2 text-xs hover:bg-black hover:text-white hover:border-solid transition-all uppercase",children:["Run ",e.name,".exe"]})]})},e.id))})]});var ta=e.i(47167);class tu{}function tp(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){let e=t[n];return null!=e?String(e):""}throw Error(`Key '${n}' not found in valueMap.`)})}function td(e,t,n){for(let i=0;i<t.length-1;i++){let l=t[i];if(l.endsWith("[]")){let r=l.slice(0,-2);if(!(r in e))if(Array.isArray(n))e[r]=Array.from({length:n.length},()=>({}));else throw Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[r])){let l=e[r];if(Array.isArray(n))for(let e=0;e<l.length;e++)td(l[e],t.slice(i+1),n[e]);else for(let e of l)td(e,t.slice(i+1),n)}return}if(l.endsWith("[0]")){let r=l.slice(0,-3);r in e||(e[r]=[{}]),td(e[r][0],t.slice(i+1),n);return}e[l]&&"object"==typeof e[l]||(e[l]={}),e=e[l]}let i=t[t.length-1],l=e[i];if(void 0!==l){if(!n||"object"==typeof n&&0===Object.keys(n).length||n===l)return;if("object"==typeof l&&"object"==typeof n&&null!==l&&null!==n)Object.assign(l,n);else throw Error(`Cannot set value for an existing key. Key: ${i}`)}else"_self"!==i||"object"!=typeof n||null===n||Array.isArray(n)?e[i]=n:Object.assign(e,n)}function tc(e,t,n){try{if(1===t.length&&"_self"===t[0])return e;for(let i=0;i<t.length;i++){if("object"!=typeof e||null===e)return n;let l=t[i];if(l.endsWith("[]")){let r=l.slice(0,-2);if(!(r in e))return n;{let l=e[r];if(!Array.isArray(l))return n;return l.map(e=>tc(e,t.slice(i+1),n))}}e=e[l]}return e}catch(e){if(e instanceof TypeError)return n;throw e}}function th(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e}function tm(e){var t;let n,i,l,r,o={},s=tc(e,["name"]);null!=s&&td(o,["name"],s);let a=tc(e,["metadata"]);null!=a&&td(o,["metadata"],a);let u=tc(e,["done"]);null!=u&&td(o,["done"],u);let p=tc(e,["error"]);null!=p&&td(o,["error"],p);let d=tc(e,["response"]);return null!=d&&td(o,["response"],(n={},null!=(i=tc(t=d,["sdkHttpResponse"]))&&td(n,["sdkHttpResponse"],i),null!=(l=tc(t,["parent"]))&&td(n,["parent"],l),null!=(r=tc(t,["documentName"]))&&td(n,["documentName"],r),n)),o}(i=er||(er={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(l=eo||(eo={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",l.PYTHON="PYTHON",(r=es||(es={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",r.SILENT="SILENT",r.WHEN_IDLE="WHEN_IDLE",r.INTERRUPT="INTERRUPT",(o=ea||(ea={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT",o.NULL="NULL",(s=eu||(eu={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.MODE_DYNAMIC="MODE_DYNAMIC",(a=ep||(ep={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",a.SIMPLE_SEARCH="SIMPLE_SEARCH",a.ELASTIC_SEARCH="ELASTIC_SEARCH",(u=ed||(ed={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",u.NO_AUTH="NO_AUTH",u.API_KEY_AUTH="API_KEY_AUTH",u.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",u.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",u.OAUTH="OAUTH",u.OIDC_AUTH="OIDC_AUTH",(p=ec||(ec={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",p.HTTP_IN_QUERY="HTTP_IN_QUERY",p.HTTP_IN_HEADER="HTTP_IN_HEADER",p.HTTP_IN_PATH="HTTP_IN_PATH",p.HTTP_IN_BODY="HTTP_IN_BODY",p.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(d=eh||(eh={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",d.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",d.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",d.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",d.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",d.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",d.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(c=em||(em={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",c.LOW="LOW",c.HIGH="HIGH",(h=ef||(ef={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",h.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",h.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",h.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",h.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",h.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",h.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",h.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",h.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",h.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",h.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(m=eg||(eg={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",m.SEVERITY="SEVERITY",m.PROBABILITY="PROBABILITY",(f=ey||(ey={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",f.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",f.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",f.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",f.BLOCK_NONE="BLOCK_NONE",f.OFF="OFF",(g=eE||(eE={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",g.STOP="STOP",g.MAX_TOKENS="MAX_TOKENS",g.SAFETY="SAFETY",g.RECITATION="RECITATION",g.LANGUAGE="LANGUAGE",g.OTHER="OTHER",g.BLOCKLIST="BLOCKLIST",g.PROHIBITED_CONTENT="PROHIBITED_CONTENT",g.SPII="SPII",g.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",g.IMAGE_SAFETY="IMAGE_SAFETY",g.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",g.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",g.NO_IMAGE="NO_IMAGE",(y=e_||(e_={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",y.NEGLIGIBLE="NEGLIGIBLE",y.LOW="LOW",y.MEDIUM="MEDIUM",y.HIGH="HIGH",(E=eI||(eI={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",E.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",E.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",E.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",E.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(_=ev||(ev={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",_.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",_.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",_.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",_.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(I=eT||(eT={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",I.SAFETY="SAFETY",I.OTHER="OTHER",I.BLOCKLIST="BLOCKLIST",I.PROHIBITED_CONTENT="PROHIBITED_CONTENT",I.IMAGE_SAFETY="IMAGE_SAFETY",I.MODEL_ARMOR="MODEL_ARMOR",I.JAILBREAK="JAILBREAK",(v=eA||(eA={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",v.ON_DEMAND="ON_DEMAND",v.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(T=eC||(eC={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",T.TEXT="TEXT",T.IMAGE="IMAGE",T.AUDIO="AUDIO",(A=eS||(eS={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",A.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",A.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",A.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(C=eO||(eO={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",C.TUNING_MODE_FULL="TUNING_MODE_FULL",C.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(S=eb||(eb={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",S.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",S.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",S.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",S.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",S.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",S.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(O=eN||(eN={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",O.JOB_STATE_QUEUED="JOB_STATE_QUEUED",O.JOB_STATE_PENDING="JOB_STATE_PENDING",O.JOB_STATE_RUNNING="JOB_STATE_RUNNING",O.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",O.JOB_STATE_FAILED="JOB_STATE_FAILED",O.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",O.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",O.JOB_STATE_PAUSED="JOB_STATE_PAUSED",O.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",O.JOB_STATE_UPDATING="JOB_STATE_UPDATING",O.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(b=eR||(eR={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",b.TUNING_TASK_I2V="TUNING_TASK_I2V",b.TUNING_TASK_T2V="TUNING_TASK_T2V",b.TUNING_TASK_R2V="TUNING_TASK_R2V",(N=eP||(eP={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",N.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",N.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",N.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(R=ex||(ex={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",R.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",R.BALANCED="BALANCED",R.PRIORITIZE_COST="PRIORITIZE_COST",(P=eD||(eD={})).UNSPECIFIED="UNSPECIFIED",P.BLOCKING="BLOCKING",P.NON_BLOCKING="NON_BLOCKING",(x=ew||(ew={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",x.MODE_DYNAMIC="MODE_DYNAMIC",(D=eM||(eM={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",D.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(w=eU||(eU={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",w.AUTO="AUTO",w.ANY="ANY",w.NONE="NONE",w.VALIDATED="VALIDATED",(M=ek||(ek={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",M.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",M.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",M.BLOCK_NONE="BLOCK_NONE",(U=eL||(eL={})).DONT_ALLOW="DONT_ALLOW",U.ALLOW_ADULT="ALLOW_ADULT",U.ALLOW_ALL="ALLOW_ALL",(k=eq||(eq={})).auto="auto",k.en="en",k.ja="ja",k.ko="ko",k.hi="hi",k.zh="zh",k.pt="pt",k.es="es",(L=eG||(eG={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",L.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",L.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",L.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",L.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(q=ej||(ej={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",q.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",q.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",q.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(G=eH||(eH={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",G.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",G.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",G.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(j=eF||(eF={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",j.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",j.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",j.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",j.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",j.EDIT_MODE_STYLE="EDIT_MODE_STYLE",j.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",j.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(H=eV||(eV={})).FOREGROUND="FOREGROUND",H.BACKGROUND="BACKGROUND",H.PROMPT="PROMPT",H.SEMANTIC="SEMANTIC",H.INTERACTIVE="INTERACTIVE",(F=eB||(eB={})).ASSET="ASSET",F.STYLE="STYLE",(V=eJ||(eJ={})).INSERT="INSERT",V.REMOVE="REMOVE",V.REMOVE_STATIC="REMOVE_STATIC",V.OUTPAINT="OUTPAINT",(B=eY||(eY={})).OPTIMIZED="OPTIMIZED",B.LOSSLESS="LOSSLESS",(J=eW||(eW={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",J.PREFERENCE_TUNING="PREFERENCE_TUNING",(Y=eK||(eK={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Y.STATE_PENDING="STATE_PENDING",Y.STATE_ACTIVE="STATE_ACTIVE",Y.STATE_FAILED="STATE_FAILED",(W=e$||(e$={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",W.PROCESSING="PROCESSING",W.ACTIVE="ACTIVE",W.FAILED="FAILED",(K=ez||(ez={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",K.UPLOADED="UPLOADED",K.GENERATED="GENERATED",($=eX||(eX={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",$.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",$.RESPONSE_REJECTED="RESPONSE_REJECTED",$.NEED_MORE_INPUT="NEED_MORE_INPUT",(z=eQ||(eQ={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",z.TEXT="TEXT",z.IMAGE="IMAGE",z.VIDEO="VIDEO",z.AUDIO="AUDIO",z.DOCUMENT="DOCUMENT",(X=eZ||(eZ={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",X.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",X.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(Q=e0||(e0={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",Q.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",Q.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(Z=e1||(e1={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",Z.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",Z.NO_INTERRUPTION="NO_INTERRUPTION",(ee=e2||(e2={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",ee.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",ee.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(et=e4||(e4={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",et.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",et.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",et.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",et.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",et.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",et.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",et.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",et.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",et.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",et.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",et.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",et.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(en=e6||(e6={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",en.QUALITY="QUALITY",en.DIVERSITY="DIVERSITY",en.VOCALIZATION="VOCALIZATION",(ei=e3||(e3={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",ei.PLAY="PLAY",ei.PAUSE="PAUSE",ei.STOP="STOP",ei.RESET_CONTEXT="RESET_CONTEXT";class tf{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class tg{get text(){var e,t,n,i,l,r,o,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let a="",u=!1,p=[];for(let e of null!=(s=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?s:[]){for(let[t,n]of Object.entries(e))"text"!==t&&"thought"!==t&&"thoughtSignature"!==t&&(null!==n||void 0!==n)&&p.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,a+=e.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?a:void 0}get data(){var e,t,n,i,l,r,o,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let a="",u=[];for(let e of null!=(s=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?s:[]){for(let[t,n]of Object.entries(e))"inlineData"!==t&&(null!==n||void 0!==n)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(a+=atob(e.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}get functionCalls(){var e,t,n,i,l,r,o,s;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let a=null==(s=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?void 0:s.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==a?void 0:a.length)!==0)return a}get executableCode(){var e,t,n,i,l,r,o,s,a;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null==(s=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?void 0:s.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(a=null==u?void 0:u[0])?void 0:a.code}get codeExecutionResult(){var e,t,n,i,l,r,o,s,a;if((null==(i=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null==(s=null==(o=null==(r=null==(l=this.candidates)?void 0:l[0])?void 0:r.content)?void 0:o.parts)?void 0:s.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(a=null==u?void 0:u[0])?void 0:a.output}}class ty{}class tE{}class t_{}class tI{}class tv{}class tT{}class tA{}class tC{}class tS{}class tO{}class tb{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n,i=new tb;if(t){let t,i,l,r,o,s;t={},null!=(i=tc(e,["name"]))&&td(t,["name"],i),null!=(l=tc(e,["metadata"]))&&td(t,["metadata"],l),null!=(r=tc(e,["done"]))&&td(t,["done"],r),null!=(o=tc(e,["error"]))&&td(t,["error"],o),null!=(s=tc(e,["response"]))&&td(t,["response"],function(e){let t={},n=tc(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s;return n={},null!=(i=tc(e,["_self"]))&&td(n,["video"],(l={},null!=(r=tc(t=i,["gcsUri"]))&&td(l,["uri"],r),null!=(o=tc(t,["bytesBase64Encoded"]))&&td(l,["videoBytes"],th(o)),null!=(s=tc(t,["mimeType"]))&&td(l,["mimeType"],s),l)),n})),td(t,["generatedVideos"],e)}let i=tc(e,["raiMediaFilteredCount"]);null!=i&&td(t,["raiMediaFilteredCount"],i);let l=tc(e,["raiMediaFilteredReasons"]);return null!=l&&td(t,["raiMediaFilteredReasons"],l),t}(s)),n=t}else{let t,i,l,r,o,s;t={},null!=(i=tc(e,["name"]))&&td(t,["name"],i),null!=(l=tc(e,["metadata"]))&&td(t,["metadata"],l),null!=(r=tc(e,["done"]))&&td(t,["done"],r),null!=(o=tc(e,["error"]))&&td(t,["error"],o),null!=(s=tc(e,["response","generateVideoResponse"]))&&td(t,["response"],function(e){let t={},n=tc(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s;return n={},null!=(i=tc(e,["video"]))&&td(n,["video"],(l={},null!=(r=tc(t=i,["uri"]))&&td(l,["uri"],r),null!=(o=tc(t,["encodedVideo"]))&&td(l,["videoBytes"],th(o)),null!=(s=tc(t,["encoding"]))&&td(l,["mimeType"],s),l)),n})),td(t,["generatedVideos"],e)}let i=tc(e,["raiMediaFilteredCount"]);null!=i&&td(t,["raiMediaFilteredCount"],i);let l=tc(e,["raiMediaFilteredReasons"]);return null!=l&&td(t,["raiMediaFilteredReasons"],l),t}(s)),n=t}return Object.assign(i,n),i}}class tN{}class tR{}class tP{}class tx{}class tD{}class tw{}class tM{}class tU{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){var n;let i,l,r,o,s,a,u,p,d,c,h=new tU;return Object.assign(h,(s={},null!=(a=tc(e,["name"]))&&td(s,["name"],a),null!=(u=tc(e,["metadata"]))&&td(s,["metadata"],u),null!=(p=tc(e,["done"]))&&td(s,["done"],p),null!=(d=tc(e,["error"]))&&td(s,["error"],d),null!=(c=tc(e,["response"]))&&td(s,["response"],(i={},null!=(l=tc(n=c,["sdkHttpResponse"]))&&td(i,["sdkHttpResponse"],l),null!=(r=tc(n,["parent"]))&&td(i,["parent"],r),null!=(o=tc(n,["documentName"]))&&td(i,["documentName"],o),i)),s)),h}}class tk{}class tL{}class tq{}class tG{}class tj{get text(){var e,t,n;let i="",l=!1,r=[];for(let o of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&r.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;l=!0,i+=o.text}}return r.length>0&&console.warn(`there are non-text parts ${r} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?i:void 0}get data(){var e,t,n;let i="",l=[];for(let r of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(r))"inlineData"!==e&&null!==t&&l.push(e);r.inlineData&&"string"==typeof r.inlineData.data&&(i+=atob(r.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class tH{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class tF{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n=new tF;return Object.assign(n,tm(e)),n}}function tV(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw Error("invalid model parameter");if(e.isVertexAI())if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;else{if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function tB(e,t){let n=tV(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function tJ(e){return Array.isArray(e)?e.map(e=>tY(e)):[tY(e)]}function tY(e){if("object"==typeof e&&null!==e)return e;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function tW(e){let t=tY(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function tK(e){let t=tY(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function t$(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error(`Unsupported part type: ${typeof e}`)}function tz(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>t$(e)):[t$(e)]}function tX(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function tQ(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function tZ(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function t0(e){if(null==e)throw Error("ContentUnion is required");return tX(e)?e:{role:"user",parts:tz(e)}}function t1(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=t0(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){let e=t0(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>t0(e)):[t0(t)]}function t2(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(tQ(e)||tZ(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[t0(e)]}let t=[],n=[],i=tX(e[0]);for(let l of e){let e=tX(l);if(e!=i)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(l);else if(tQ(l)||tZ(l))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else n.push(l)}return i||t.push({role:"user",parts:tz(n)}),t}function t4(e){let t={},n=["items"],i=["anyOf"],l=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let r=e.anyOf;for(let[o,s]of(null!=r&&2==r.length&&("null"===r[0].type?(t.nullable=!0,e=r[1]):"null"===r[1].type&&(t.nullable=!0,e=r[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(ea).includes(n[0].toUpperCase())?n[0].toUpperCase():ea.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],n))t.anyOf.push({type:Object.values(ea).includes(e.toUpperCase())?e.toUpperCase():ea.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=s)if("type"==o){if("null"===s)throw Error("type: null can not be the only possible type for the field.");if(s instanceof Array)continue;t.type=Object.values(ea).includes(s.toUpperCase())?s.toUpperCase():ea.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=t4(s);else if(i.includes(o)){let e=[];for(let n of s){if("null"==n.type){t.nullable=!0;continue}e.push(t4(n))}t[o]=e}else if(l.includes(o)){let e={};for(let[t,n]of Object.entries(s))e[t]=t4(n);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=s}return t}function t6(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error(`Unsupported speechConfig type: ${typeof e}`)}function t3(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function t5(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=t4(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=t4(t.response));return e}function t7(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let n of e)t.push(n);return t}function t8(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,n,i=1){let l=!t.startsWith(`${n}/`)&&t.split("/").length===i;if(e.isVertexAI())if(t.startsWith("projects/"))return t;else if(t.startsWith("locations/"))return`projects/${e.getProject()}/${t}`;else if(t.startsWith(`${n}/`))return`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`;else if(l)return`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`;else return t;return l?`${n}/${t}`:t}(e,t,"cachedContents")}function t9(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function ne(e){var t;let n;if(null!=e&&"object"==typeof e&&"name"in e&&(n=e.name),null==e||"object"!=typeof e||!("uri"in e)||void 0!==(n=e.uri)){if(null==e||"object"!=typeof e||!("video"in e)||void 0!==(n=null==(t=e.video)?void 0:t.uri)){if("string"==typeof e&&(n=e),void 0===n)throw Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){let e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}}function nt(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function nn(e){for(let i of["models","tunedModels","publisherModels"]){var t,n;if(t=e,n=i,null!==t&&"object"==typeof t&&n in t)return e[i]}return[]}function ni(e,t){let n;if("string"==typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;let i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,l=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(l>0||1!==i)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||1!==l)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function nl(e){if("object"!=typeof e||null===e)return{};let t=e.inlinedResponses;if("object"!=typeof t||null===t)return e;let n=t.inlinedResponses;if(!Array.isArray(n)||0===n.length)return e;let i=!1;for(let e of n){if("object"!=typeof e||null===e)continue;let t=e.response;if("object"==typeof t&&null!==t&&void 0!==t.embedding){i=!0;break}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),e}function nr(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error(`Invalid batch job name: ${t}.`)}function no(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===e)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===e)return"JOB_STATE_EXPIRED";else return e}function ns(e){let t={},n=tc(e,["name"]);null!=n&&td(t,["name"],n);let i=tc(e,["metadata","displayName"]);null!=i&&td(t,["displayName"],i);let l=tc(e,["metadata","state"]);null!=l&&td(t,["state"],no(l));let r=tc(e,["metadata","createTime"]);null!=r&&td(t,["createTime"],r);let o=tc(e,["metadata","endTime"]);null!=o&&td(t,["endTime"],o);let s=tc(e,["metadata","updateTime"]);null!=s&&td(t,["updateTime"],s);let a=tc(e,["metadata","model"]);null!=a&&td(t,["model"],a);let u=tc(e,["metadata","output"]);return null!=u&&td(t,["dest"],function(e){let t={},n=tc(e,["responsesFile"]);null!=n&&td(t,["fileName"],n);let i=tc(e,["inlinedResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l;return n={},null!=(i=tc(t=e,["response"]))&&td(n,["response"],function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["content"]);null!=n&&td(t,["content"],n);let i=tc(e,["citationMetadata"]);null!=i&&td(t,["citationMetadata"],function(e){let t={},n=tc(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["citations"],e)}return t}(i));let l=tc(e,["tokenCount"]);null!=l&&td(t,["tokenCount"],l);let r=tc(e,["finishReason"]);null!=r&&td(t,["finishReason"],r);let o=tc(e,["avgLogprobs"]);null!=o&&td(t,["avgLogprobs"],o);let s=tc(e,["groundingMetadata"]);null!=s&&td(t,["groundingMetadata"],s);let a=tc(e,["index"]);null!=a&&td(t,["index"],a);let u=tc(e,["logprobsResult"]);null!=u&&td(t,["logprobsResult"],u);let p=tc(e,["safetyRatings"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["safetyRatings"],e)}let d=tc(e,["urlContextMetadata"]);return null!=d&&td(t,["urlContextMetadata"],d),t})(e))),td(t,["candidates"],e)}let l=tc(e,["modelVersion"]);null!=l&&td(t,["modelVersion"],l);let r=tc(e,["promptFeedback"]);null!=r&&td(t,["promptFeedback"],r);let o=tc(e,["responseId"]);null!=o&&td(t,["responseId"],o);let s=tc(e,["usageMetadata"]);return null!=s&&td(t,["usageMetadata"],s),t}(i)),null!=(l=tc(t,["error"]))&&td(n,["error"],l),n})),td(t,["inlinedResponses"],e)}let l=tc(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["inlinedEmbedContentResponses"],e)}return t}(nl(u))),t}function na(e){var t,n;let i,l,r,o,s,a,u,p,d={},c=tc(e,["name"]);null!=c&&td(d,["name"],c);let h=tc(e,["displayName"]);null!=h&&td(d,["displayName"],h);let m=tc(e,["state"]);null!=m&&td(d,["state"],no(m));let f=tc(e,["error"]);null!=f&&td(d,["error"],f);let g=tc(e,["createTime"]);null!=g&&td(d,["createTime"],g);let y=tc(e,["startTime"]);null!=y&&td(d,["startTime"],y);let E=tc(e,["endTime"]);null!=E&&td(d,["endTime"],E);let _=tc(e,["updateTime"]);null!=_&&td(d,["updateTime"],_);let I=tc(e,["model"]);null!=I&&td(d,["model"],I);let v=tc(e,["inputConfig"]);null!=v&&td(d,["src"],(i={},null!=(l=tc(n=v,["instancesFormat"]))&&td(i,["format"],l),null!=(r=tc(n,["gcsSource","uris"]))&&td(i,["gcsUri"],r),null!=(o=tc(n,["bigquerySource","inputUri"]))&&td(i,["bigqueryUri"],o),i));let T=tc(e,["outputConfig"]);null!=T&&td(d,["dest"],(t=nl(T),s={},null!=(a=tc(t,["predictionsFormat"]))&&td(s,["format"],a),null!=(u=tc(t,["gcsDestination","outputUriPrefix"]))&&td(s,["gcsUri"],u),null!=(p=tc(t,["bigqueryDestination","outputUri"]))&&td(s,["bigqueryUri"],p),s));let A=tc(e,["completionStats"]);return null!=A&&td(d,["completionStats"],A),d}function nu(e){let t={},n=tc(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s,a,u,p,d,c,h;return n={},null!=(i=tc(t=e,["mediaResolution"]))&&td(n,["mediaResolution"],i),null!=(l=tc(t,["codeExecutionResult"]))&&td(n,["codeExecutionResult"],l),null!=(r=tc(t,["executableCode"]))&&td(n,["executableCode"],r),null!=(o=tc(t,["fileData"]))&&td(n,["fileData"],function(e){let t={};if(void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tc(e,["fileUri"]);null!=n&&td(t,["fileUri"],n);let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(o)),null!=(s=tc(t,["functionCall"]))&&td(n,["functionCall"],function(e){let t={},n=tc(e,["id"]);null!=n&&td(t,["id"],n);let i=tc(e,["args"]);null!=i&&td(t,["args"],i);let l=tc(e,["name"]);if(null!=l&&td(t,["name"],l),void 0!==tc(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tc(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=tc(t,["functionResponse"]))&&td(n,["functionResponse"],a),null!=(u=tc(t,["inlineData"]))&&td(n,["inlineData"],function(e){let t={},n=tc(e,["data"]);if(null!=n&&td(t,["data"],n),void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(u)),null!=(p=tc(t,["text"]))&&td(n,["text"],p),null!=(d=tc(t,["thought"]))&&td(n,["thought"],d),null!=(c=tc(t,["thoughtSignature"]))&&td(n,["thoughtSignature"],c),null!=(h=tc(t,["videoMetadata"]))&&td(n,["videoMetadata"],h),n})),td(t,["parts"],e)}let i=tc(e,["role"]);return null!=i&&td(t,["role"],i),t}function np(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["_url","model"],tV(e,i));let l=tc(t,["src"]);null!=l&&td(n,["batch","inputConfig"],function(e,t){let n={};if(void 0!==tc(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==tc(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==tc(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let i=tc(t,["fileName"]);null!=i&&td(n,["fileName"],i);let l=tc(t,["inlinedRequests"]);if(null!=l){let t=l;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["request","model"],tV(e,i));let l=tc(t,["contents"]);if(null!=l){let e=t2(l);Array.isArray(e)&&(e=e.map(e=>nu(e))),td(n,["request","contents"],e)}let r=tc(t,["metadata"]);null!=r&&td(n,["metadata"],r);let o=tc(t,["config"]);return null!=o&&td(n,["request","generationConfig"],function(e,t,n){var i;let l,r,o,s={},a=tc(t,["systemInstruction"]);void 0!==n&&null!=a&&td(n,["systemInstruction"],nu(t0(a)));let u=tc(t,["temperature"]);null!=u&&td(s,["temperature"],u);let p=tc(t,["topP"]);null!=p&&td(s,["topP"],p);let d=tc(t,["topK"]);null!=d&&td(s,["topK"],d);let c=tc(t,["candidateCount"]);null!=c&&td(s,["candidateCount"],c);let h=tc(t,["maxOutputTokens"]);null!=h&&td(s,["maxOutputTokens"],h);let m=tc(t,["stopSequences"]);null!=m&&td(s,["stopSequences"],m);let f=tc(t,["responseLogprobs"]);null!=f&&td(s,["responseLogprobs"],f);let g=tc(t,["logprobs"]);null!=g&&td(s,["logprobs"],g);let y=tc(t,["presencePenalty"]);null!=y&&td(s,["presencePenalty"],y);let E=tc(t,["frequencyPenalty"]);null!=E&&td(s,["frequencyPenalty"],E);let _=tc(t,["seed"]);null!=_&&td(s,["seed"],_);let I=tc(t,["responseMimeType"]);null!=I&&td(s,["responseMimeType"],I);let v=tc(t,["responseSchema"]);null!=v&&td(s,["responseSchema"],t4(v));let T=tc(t,["responseJsonSchema"]);if(null!=T&&td(s,["responseJsonSchema"],T),void 0!==tc(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==tc(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let A=tc(t,["safetySettings"]);if(void 0!==n&&null!=A){let e=A;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["category"]);if(null!=n&&td(t,["category"],n),void 0!==tc(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=tc(e,["threshold"]);return null!=i&&td(t,["threshold"],i),t})(e))),td(n,["safetySettings"],e)}let C=tc(t,["tools"]);if(void 0!==n&&null!=C){let e=t7(C);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["functionDeclarations"],e)}if(void 0!==tc(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tc(e,["googleSearchRetrieval"]);null!=i&&td(t,["googleSearchRetrieval"],i);let l=tc(e,["computerUse"]);null!=l&&td(t,["computerUse"],l);let r=tc(e,["fileSearch"]);null!=r&&td(t,["fileSearch"],r);let o=tc(e,["codeExecution"]);if(null!=o&&td(t,["codeExecution"],o),void 0!==tc(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=tc(e,["googleMaps"]);null!=s&&td(t,["googleMaps"],function(e){let t={};if(void 0!==tc(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tc(e,["enableWidget"]);return null!=n&&td(t,["enableWidget"],n),t}(s));let a=tc(e,["googleSearch"]);null!=a&&td(t,["googleSearch"],function(e){let t={};if(void 0!==tc(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tc(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tc(e,["timeRangeFilter"]);return null!=n&&td(t,["timeRangeFilter"],n),t}(a));let u=tc(e,["urlContext"]);return null!=u&&td(t,["urlContext"],u),t})(t5(e)))),td(n,["tools"],e)}let S=tc(t,["toolConfig"]);if(void 0!==n&&null!=S&&td(n,["toolConfig"],(l={},null!=(r=tc(i=S,["functionCallingConfig"]))&&td(l,["functionCallingConfig"],function(e){let t={},n=tc(e,["mode"]);null!=n&&td(t,["mode"],n);let i=tc(e,["allowedFunctionNames"]);if(null!=i&&td(t,["allowedFunctionNames"],i),void 0!==tc(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r)),null!=(o=tc(i,["retrievalConfig"]))&&td(l,["retrievalConfig"],o),l)),void 0!==tc(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let O=tc(t,["cachedContent"]);void 0!==n&&null!=O&&td(n,["cachedContent"],t8(e,O));let b=tc(t,["responseModalities"]);null!=b&&td(s,["responseModalities"],b);let N=tc(t,["mediaResolution"]);null!=N&&td(s,["mediaResolution"],N);let R=tc(t,["speechConfig"]);if(null!=R&&td(s,["speechConfig"],t6(R)),void 0!==tc(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let P=tc(t,["thinkingConfig"]);null!=P&&td(s,["thinkingConfig"],P);let x=tc(t,["imageConfig"]);return null!=x&&td(s,["imageConfig"],function(e){let t={},n=tc(e,["aspectRatio"]);null!=n&&td(t,["aspectRatio"],n);let i=tc(e,["imageSize"]);if(null!=i&&td(t,["imageSize"],i),void 0!==tc(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==tc(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(x)),s}(e,o,tc(n,["request"],{}))),n})(e,t))),td(n,["requests","requests"],t)}return n}(e,ni(e,l)));let r=tc(t,["config"]);return null!=r&&function(e,t){let n=tc(e,["displayName"]);if(void 0!==t&&null!=n&&td(t,["batch","displayName"],n),void 0!==tc(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(r,n),n}(el=e5||(e5={})).PAGED_ITEM_BATCH_JOBS="batchJobs",el.PAGED_ITEM_MODELS="models",el.PAGED_ITEM_TUNING_JOBS="tuningJobs",el.PAGED_ITEM_FILES="files",el.PAGED_ITEM_CACHED_CONTENTS="cachedContents",el.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",el.PAGED_ITEM_DOCUMENTS="documents";class nd{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let r={config:{}};(r=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}}).config&&(r.config.pageToken=t.nextPageToken),this.paramsInternal=r,this.pageInternalSize=null!=(l=null==(i=r.config)?void 0:i.pageSize)?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null==(e=this.params.config)?void 0:e.pageToken)!==void 0}}class nc extends tu{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nd(e5.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)}}createInlinedGenerateContentRequest(e){let t=np(this.apiClient,e),n=tp("{model}:batchGenerateContent",t._url),i=t.batch.inputConfig.requests,l=i.requests,r=[];for(let e of l){let t=Object.assign({},e);if(t.systemInstruction){let e=t.systemInstruction;delete t.systemInstruction;let n=t.request;n.systemInstruction=e,t.request=n}r.push(t)}return i.requests=r,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){let n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),void 0===n.dest){let t=this.getGcsUri(e),l=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest=`${t.slice(0,-6)}/dest`:n.dest=`${t}_dest_${i}`;else if(l)n.dest=`${l}_dest_${i}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,i,l,r;let o="",s={};if(this.apiClient.isVertexAI()){let i,l,a,u,p,d,c=(r=this.apiClient,i={},null!=(l=tc(e,["model"]))&&td(i,["model"],tV(r,l)),null!=(a=tc(e,["src"]))&&td(i,["inputConfig"],function(e){let t={},n=tc(e,["format"]);null!=n&&td(t,["instancesFormat"],n);let i=tc(e,["gcsUri"]);null!=i&&td(t,["gcsSource","uris"],i);let l=tc(e,["bigqueryUri"]);if(null!=l&&td(t,["bigquerySource","inputUri"],l),void 0!==tc(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==tc(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(ni(r,a))),null!=(u=tc(e,["config"]))&&(p=tc(u,["displayName"]),void 0!==i&&null!=p&&td(i,["displayName"],p),d=tc(u,["dest"]),void 0!==i&&null!=d&&td(i,["outputConfig"],function(e){let t={},n=tc(e,["format"]);null!=n&&td(t,["predictionsFormat"],n);let i=tc(e,["gcsUri"]);null!=i&&td(t,["gcsDestination","outputUriPrefix"],i);let l=tc(e,["bigqueryUri"]);if(null!=l&&td(t,["bigqueryDestination","outputUri"],l),void 0!==tc(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==tc(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==tc(e,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error(`Unsupported destination: ${e}`)}(d)))),i);return o=tp("batchPredictionJobs",c._url),s=c._query,delete c._url,delete c._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>na(e))}{let t=np(this.apiClient,e);return o=tp("{model}:batchGenerateContent",t._url),s=t._query,delete t._url,delete t._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>ns(e))}}async createEmbeddingsInternal(e){var t,n,i,l,r;let o="",s={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let a,u,p,d,c,h,m,f,g=(i=this.apiClient,d={},null!=(c=tc(e,["model"]))&&td(d,["_url","model"],tV(i,c)),null!=(h=tc(e,["src"]))&&td(d,["batch","inputConfig"],(l=i,a={},null!=(u=tc(r=h,["fileName"]))&&td(a,["file_name"],u),null!=(p=tc(r,["inlinedRequests"]))&&td(a,["requests"],function(e,t){let n={},i=tc(t,["contents"]);if(null!=i){let t=t1(e,i);Array.isArray(t)&&(t=t.map(e=>e)),td(n,["requests[]","request","content"],t)}let l=tc(t,["config"]);return null!=l&&(td(n,["_self"],function(e,t){let n=tc(e,["taskType"]);void 0!==t&&null!=n&&td(t,["requests[]","taskType"],n);let i=tc(e,["title"]);void 0!==t&&null!=i&&td(t,["requests[]","title"],i);let l=tc(e,["outputDimensionality"]);if(void 0!==t&&null!=l&&td(t,["requests[]","outputDimensionality"],l),void 0!==tc(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==tc(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(l,n)),!function(e,t){for(let[n,i]of Object.entries(t)){let t=n.split("."),l=i.split("."),r=new Set,o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&l.length>o)for(let e=o;e<l.length;e++){let t=l[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||r.add(t)}!function e(t,n,i,l,r){if(l>=n.length||"object"!=typeof t||null===t)return;let o=n[l];if(o.endsWith("[]")){let s=o.slice(0,-2);if(s in t&&Array.isArray(t[s]))for(let o of t[s])e(o,n,i,l+1,r)}else if("*"===o){if("object"==typeof t&&null!==t&&!Array.isArray(t)){let e=Object.keys(t).filter(e=>!e.startsWith("_")&&!r.has(e)),n={};for(let i of e)n[i]=t[i];for(let[e,r]of Object.entries(n)){let n=[];for(let t of i.slice(l))"*"===t?n.push(e):n.push(t);td(t,n,r)}for(let n of e)delete t[n]}}else o in t&&e(t[o],n,i,l+1,r)}(e,t,l,0,r)}}(n,{"requests[].*":"requests[].request.*"})),n}(l,p)),a)),null!=(m=tc(e,["config"]))&&(f=tc(m,["displayName"]),void 0!==d&&null!=f&&td(d,["batch","displayName"],f)),d);return o=tp("{model}:asyncBatchEmbedContent",g._url),s=g._query,delete g._url,delete g._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>ns(e))}}async get(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],nr(r,l)),i);return s=tp("batchPredictionJobs/{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>na(e))}{let t,n,r=(o=this.apiClient,t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],nr(o,n)),t);return s=tp("batches/{name}",r._url),a=r._query,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>ns(e))}}async cancel(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],nr(r,l)),i);s=tp("batchPredictionJobs/{name}:cancel",o._url),a=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}else{let t,n,r=(o=this.apiClient,t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],nr(o,n)),t);s=tp("batches/{name}:cancel",r._url),a=r._query,delete r._url,delete r._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal})}}async listInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,s,a,u,p=(i={},null!=(l=tc(e,["config"]))&&(s=tc(l,["pageSize"]),void 0!==i&&null!=s&&td(i,["_query","pageSize"],s),a=tc(l,["pageToken"]),void 0!==i&&null!=a&&td(i,["_query","pageToken"],a),u=tc(l,["filter"]),void 0!==i&&null!=u&&td(i,["_query","filter"],u)),i);return r=tp("batchPredictionJobs",p._url),o=p._query,delete p._url,delete p._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["batchPredictionJobs"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>na(e))),td(t,["batchJobs"],e)}return t}(e),n=new tG;return Object.assign(n,t),n})}{let t,n,s=(t={},null!=(n=tc(e,["config"]))&&function(e,t){let n=tc(e,["pageSize"]);void 0!==t&&null!=n&&td(t,["_query","pageSize"],n);let i=tc(e,["pageToken"]);if(void 0!==t&&null!=i&&td(t,["_query","pageToken"],i),void 0!==tc(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(n,t),t);return r=tp("batches",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["operations"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>ns(e))),td(t,["batchJobs"],e)}return t}(e),n=new tG;return Object.assign(n,t),n})}}async delete(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],nr(r,l)),i);return s=tp("batchPredictionJobs/{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r;return t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),null!=(i=tc(e,["name"]))&&td(t,["name"],i),null!=(l=tc(e,["done"]))&&td(t,["done"],l),null!=(r=tc(e,["error"]))&&td(t,["error"],r),t})}{let t,n,r=(o=this.apiClient,t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],nr(o,n)),t);return s=tp("batches/{name}",r._url),a=r._query,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r;return t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),null!=(i=tc(e,["name"]))&&td(t,["name"],i),null!=(l=tc(e,["done"]))&&td(t,["done"],l),null!=(r=tc(e,["error"]))&&td(t,["error"],r),t})}}}function nh(e){let t={},n=tc(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s,a,u,p,d,c,h;return n={},null!=(i=tc(t=e,["mediaResolution"]))&&td(n,["mediaResolution"],i),null!=(l=tc(t,["codeExecutionResult"]))&&td(n,["codeExecutionResult"],l),null!=(r=tc(t,["executableCode"]))&&td(n,["executableCode"],r),null!=(o=tc(t,["fileData"]))&&td(n,["fileData"],function(e){let t={};if(void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tc(e,["fileUri"]);null!=n&&td(t,["fileUri"],n);let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(o)),null!=(s=tc(t,["functionCall"]))&&td(n,["functionCall"],function(e){let t={},n=tc(e,["id"]);null!=n&&td(t,["id"],n);let i=tc(e,["args"]);null!=i&&td(t,["args"],i);let l=tc(e,["name"]);if(null!=l&&td(t,["name"],l),void 0!==tc(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tc(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=tc(t,["functionResponse"]))&&td(n,["functionResponse"],a),null!=(u=tc(t,["inlineData"]))&&td(n,["inlineData"],function(e){let t={},n=tc(e,["data"]);if(null!=n&&td(t,["data"],n),void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(u)),null!=(p=tc(t,["text"]))&&td(n,["text"],p),null!=(d=tc(t,["thought"]))&&td(n,["thought"],d),null!=(c=tc(t,["thoughtSignature"]))&&td(n,["thoughtSignature"],c),null!=(h=tc(t,["videoMetadata"]))&&td(n,["videoMetadata"],h),n})),td(t,["parts"],e)}let i=tc(e,["role"]);return null!=i&&td(t,["role"],i),t}class nm extends tu{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nd(e5.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o,u=(r=this.apiClient,i={},null!=(l=tc(e,["model"]))&&td(i,["model"],tB(r,l)),null!=(o=tc(e,["config"]))&&function(e,t){let n=tc(e,["ttl"]);void 0!==t&&null!=n&&td(t,["ttl"],n);let i=tc(e,["expireTime"]);void 0!==t&&null!=i&&td(t,["expireTime"],i);let l=tc(e,["displayName"]);void 0!==t&&null!=l&&td(t,["displayName"],l);let r=tc(e,["contents"]);if(void 0!==t&&null!=r){let e=t2(r);Array.isArray(e)&&(e=e.map(e=>e)),td(t,["contents"],e)}let o=tc(e,["systemInstruction"]);void 0!==t&&null!=o&&td(t,["systemInstruction"],t0(o));let s=tc(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tc(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=tc(e,["description"]);null!=n&&td(t,["description"],n);let i=tc(e,["name"]);null!=i&&td(t,["name"],i);let l=tc(e,["parameters"]);null!=l&&td(t,["parameters"],l);let r=tc(e,["parametersJsonSchema"]);null!=r&&td(t,["parametersJsonSchema"],r);let o=tc(e,["response"]);null!=o&&td(t,["response"],o);let s=tc(e,["responseJsonSchema"]);return null!=s&&td(t,["responseJsonSchema"],s),t})(e))),td(t,["functionDeclarations"],e)}let i=tc(e,["retrieval"]);null!=i&&td(t,["retrieval"],i);let l=tc(e,["googleSearchRetrieval"]);null!=l&&td(t,["googleSearchRetrieval"],l);let r=tc(e,["computerUse"]);if(null!=r&&td(t,["computerUse"],r),void 0!==tc(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tc(e,["codeExecution"]);null!=o&&td(t,["codeExecution"],o);let s=tc(e,["enterpriseWebSearch"]);null!=s&&td(t,["enterpriseWebSearch"],s);let a=tc(e,["googleMaps"]);null!=a&&td(t,["googleMaps"],a);let u=tc(e,["googleSearch"]);null!=u&&td(t,["googleSearch"],u);let p=tc(e,["urlContext"]);return null!=p&&td(t,["urlContext"],p),t})(e))),td(t,["tools"],e)}let a=tc(e,["toolConfig"]);void 0!==t&&null!=a&&td(t,["toolConfig"],a);let u=tc(e,["kmsKeyName"]);void 0!==t&&null!=u&&td(t,["encryption_spec","kmsKeyName"],u)}(o,i),i);return s=tp("cachedContents",u._url),a=u._query,delete u._url,delete u._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,r,u=(o=this.apiClient,t={},null!=(n=tc(e,["model"]))&&td(t,["model"],tB(o,n)),null!=(r=tc(e,["config"]))&&function(e,t){var n;let i,l,r,o=tc(e,["ttl"]);void 0!==t&&null!=o&&td(t,["ttl"],o);let s=tc(e,["expireTime"]);void 0!==t&&null!=s&&td(t,["expireTime"],s);let a=tc(e,["displayName"]);void 0!==t&&null!=a&&td(t,["displayName"],a);let u=tc(e,["contents"]);if(void 0!==t&&null!=u){let e=t2(u);Array.isArray(e)&&(e=e.map(e=>nh(e))),td(t,["contents"],e)}let p=tc(e,["systemInstruction"]);void 0!==t&&null!=p&&td(t,["systemInstruction"],nh(t0(p)));let d=tc(e,["tools"]);if(void 0!==t&&null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["functionDeclarations"],e)}if(void 0!==tc(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tc(e,["googleSearchRetrieval"]);null!=i&&td(t,["googleSearchRetrieval"],i);let l=tc(e,["computerUse"]);null!=l&&td(t,["computerUse"],l);let r=tc(e,["fileSearch"]);null!=r&&td(t,["fileSearch"],r);let o=tc(e,["codeExecution"]);if(null!=o&&td(t,["codeExecution"],o),void 0!==tc(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=tc(e,["googleMaps"]);null!=s&&td(t,["googleMaps"],function(e){let t={};if(void 0!==tc(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tc(e,["enableWidget"]);return null!=n&&td(t,["enableWidget"],n),t}(s));let a=tc(e,["googleSearch"]);null!=a&&td(t,["googleSearch"],function(e){let t={};if(void 0!==tc(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tc(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tc(e,["timeRangeFilter"]);return null!=n&&td(t,["timeRangeFilter"],n),t}(a));let u=tc(e,["urlContext"]);return null!=u&&td(t,["urlContext"],u),t})(e))),td(t,["tools"],e)}let c=tc(e,["toolConfig"]);if(void 0!==t&&null!=c&&td(t,["toolConfig"],(i={},null!=(l=tc(n=c,["functionCallingConfig"]))&&td(i,["functionCallingConfig"],function(e){let t={},n=tc(e,["mode"]);null!=n&&td(t,["mode"],n);let i=tc(e,["allowedFunctionNames"]);if(null!=i&&td(t,["allowedFunctionNames"],i),void 0!==tc(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(l)),null!=(r=tc(n,["retrievalConfig"]))&&td(i,["retrievalConfig"],r),i)),void 0!==tc(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(r,t),t);return s=tp("cachedContents",u._url),a=u._query,delete u._url,delete u._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],t8(r,l)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,r=(o=this.apiClient,t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],t8(o,n)),t);return s=tp("{name}",r._url),a=r._query,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],t8(r,l)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tP;return Object.assign(l,i),l})}{let t,n,r=(o=this.apiClient,t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],t8(o,n)),t);return s=tp("{name}",r._url),a=r._query,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tP;return Object.assign(l,i),l})}}async update(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d=(r=this.apiClient,i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],t8(r,l)),null!=(o=tc(e,["config"]))&&(u=tc(o,["ttl"]),void 0!==i&&null!=u&&td(i,["ttl"],u),p=tc(o,["expireTime"]),void 0!==i&&null!=p&&td(i,["expireTime"],p)),i);return s=tp("{name}",d._url),a=d._query,delete d._url,delete d._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}{let t,n,r,u,p,d=(o=this.apiClient,t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],t8(o,n)),null!=(r=tc(e,["config"]))&&(u=tc(r,["ttl"]),void 0!==t&&null!=u&&td(t,["ttl"],u),p=tc(r,["expireTime"]),void 0!==t&&null!=p&&td(t,["expireTime"],p)),t);return s=tp("{name}",d._url),a=d._query,delete d._url,delete d._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>e)}}async listInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,s,a,u=(i={},null!=(l=tc(e,["config"]))&&(s=tc(l,["pageSize"]),void 0!==i&&null!=s&&td(i,["_query","pageSize"],s),a=tc(l,["pageToken"]),void 0!==i&&null!=a&&td(i,["_query","pageToken"],a)),i);return r=tp("cachedContents",u._url),o=u._query,delete u._url,delete u._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["cachedContents"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["cachedContents"],e)}return t}(e),n=new tx;return Object.assign(n,t),n})}{let t,n,s,a,u=(t={},null!=(n=tc(e,["config"]))&&(s=tc(n,["pageSize"]),void 0!==t&&null!=s&&td(t,["_query","pageSize"],s),a=tc(n,["pageToken"]),void 0!==t&&null!=a&&td(t,["_query","pageToken"],a)),t);return r=tp("cachedContents",u._url),o=u._query,delete u._url,delete u._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["cachedContents"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["cachedContents"],e)}return t}(e),n=new tx;return Object.assign(n,t),n})}}}function nf(e){return this instanceof nf?(this.v=e,this):new nf(e)}function ng(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,l=n.apply(e,t||[]),r=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),i[Symbol.asyncIterator]=function(){return this},i;function o(e,t){l[e]&&(i[e]=function(t){return new Promise(function(n,i){r.push([e,t,n,i])>1||s(e,t)})},t&&(i[e]=t(i[e])))}function s(e,t){try{var n;(n=l[e](t)).value instanceof nf?Promise.resolve(n.value.v).then(a,u):p(r[0][2],n)}catch(e){p(r[0][3],e)}}function a(e){s("next",e)}function u(e){s("throw",e)}function p(e,t){e(t),r.shift(),r.length&&s(r[0][0],r[0][1])}}function ny(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,l){var r,o,s;r=i,o=l,s=(t=e[n](t)).done,Promise.resolve(t.value).then(function(e){r({value:e,done:s})},o)})}}}function nE(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function n_(e){if(void 0===e||0===e.length)return[];let t=[],n=e.length,i=0;for(;i<n;)if("user"===e[i].role)t.push(e[i]),i++;else{let l=[],r=!0;for(;i<n&&"model"===e[i].role;)l.push(e[i]),r&&!nE(e[i])&&(r=!1),i++;r?t.push(...l):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class nI{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new nv(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class nv{constructor(e,t,n,i={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(l)}async sendMessage(e){var t;await this.sendPromise;let n=t0(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});return this.sendPromise=(async()=>{var e,t,l;let r=await i,o=null==(t=null==(e=r.candidates)?void 0:e[0])?void 0:t.content,s=r.automaticFunctionCallingHistory,a=this.getHistory(!0).length,u=[];null!=s&&(u=null!=(l=s.slice(a))?l:[]),this.recordHistory(n,o?[o]:[],u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;let n=t0(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});this.sendPromise=i.then(()=>void 0).catch(()=>void 0);let l=await i;return this.processStreamResponse(l,n)}getHistory(e=!1){return structuredClone(e?n_(this.history):this.history)}processStreamResponse(e,t){var n,i;return ng(this,arguments,function*(){var l,r,o,s;let a=[];try{for(var u,p=!0,d=ny(e);!(l=(u=yield nf(d.next())).done);p=!0){if(s=u.value,p=!1,function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let n=null==(t=e.candidates[0])?void 0:t.content;return void 0!==n&&nE(n)}(s)){let e=null==(i=null==(n=s.candidates)?void 0:n[0])?void 0:i.content;void 0!==e&&a.push(e)}yield yield nf(s)}}catch(e){r={error:e}}finally{try{!p&&!l&&(o=d.return)&&(yield nf(o.call(d)))}finally{if(r)throw r.error}}this.recordHistory(t,a)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(e=>void 0!==e.role)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...n_(n)):this.history.push(e),this.history.push(...i)}}class nT extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,nT.prototype)}}class nA extends tu{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nd(e5.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a,u=(r={},null!=(o=tc(e,["config"]))&&(s=tc(o,["pageSize"]),void 0!==r&&null!=s&&td(r,["_query","pageSize"],s),a=tc(o,["pageToken"]),void 0!==r&&null!=a&&td(r,["_query","pageToken"],a)),r);return i=tp("files",u._url),l=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["files"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["files"],e)}return t}(e),n=new tk;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s=(r={},null!=(o=tc(e,["file"]))&&td(r,["file"],o),r);return i=tp("upload/v1beta/files",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tL;return Object.assign(l,i),l})}}async get(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s=(r={},null!=(o=tc(e,["name"]))&&td(r,["_url","file"],ne(o)),r);return i=tp("files/{file}",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s=(r={},null!=(o=tc(e,["name"]))&&td(r,["_url","file"],ne(o)),r);return i=tp("files/{file}",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tq;return Object.assign(l,i),l})}}}function nC(e){let t={},n=tc(e,["data"]);if(null!=n&&td(t,["data"],n),void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}function nS(e){let t={},n=tc(e,["languageCode"]);null!=n&&td(t,["languageCode"],n);let i=tc(e,["voiceConfig"]);if(null!=i&&td(t,["voiceConfig"],i),void 0!==tc(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function nO(e){let t={},n=tc(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s,a,u,p,d,c,h;return n={},null!=(i=tc(t=e,["mediaResolution"]))&&td(n,["mediaResolution"],i),null!=(l=tc(t,["codeExecutionResult"]))&&td(n,["codeExecutionResult"],l),null!=(r=tc(t,["executableCode"]))&&td(n,["executableCode"],r),null!=(o=tc(t,["fileData"]))&&td(n,["fileData"],function(e){let t={};if(void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tc(e,["fileUri"]);null!=n&&td(t,["fileUri"],n);let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(o)),null!=(s=tc(t,["functionCall"]))&&td(n,["functionCall"],function(e){let t={},n=tc(e,["id"]);null!=n&&td(t,["id"],n);let i=tc(e,["args"]);null!=i&&td(t,["args"],i);let l=tc(e,["name"]);if(null!=l&&td(t,["name"],l),void 0!==tc(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tc(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=tc(t,["functionResponse"]))&&td(n,["functionResponse"],a),null!=(u=tc(t,["inlineData"]))&&td(n,["inlineData"],function(e){let t={},n=tc(e,["data"]);if(null!=n&&td(t,["data"],n),void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(u)),null!=(p=tc(t,["text"]))&&td(n,["text"],p),null!=(d=tc(t,["thought"]))&&td(n,["thought"],d),null!=(c=tc(t,["thoughtSignature"]))&&td(n,["thoughtSignature"],c),null!=(h=tc(t,["videoMetadata"]))&&td(n,["videoMetadata"],h),n})),td(t,["parts"],e)}let i=tc(e,["role"]);return null!=i&&td(t,["role"],i),t}function nb(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["_url","model"],tV(e,i));let l=tc(t,["contents"]);if(null!=l){let e=t2(l);Array.isArray(e)&&(e=e.map(e=>nO(e))),td(n,["contents"],e)}let r=tc(t,["config"]);return null!=r&&td(n,["generationConfig"],function(e,t,n){var i;let l,r,o,s={},a=tc(t,["systemInstruction"]);void 0!==n&&null!=a&&td(n,["systemInstruction"],nO(t0(a)));let u=tc(t,["temperature"]);null!=u&&td(s,["temperature"],u);let p=tc(t,["topP"]);null!=p&&td(s,["topP"],p);let d=tc(t,["topK"]);null!=d&&td(s,["topK"],d);let c=tc(t,["candidateCount"]);null!=c&&td(s,["candidateCount"],c);let h=tc(t,["maxOutputTokens"]);null!=h&&td(s,["maxOutputTokens"],h);let m=tc(t,["stopSequences"]);null!=m&&td(s,["stopSequences"],m);let f=tc(t,["responseLogprobs"]);null!=f&&td(s,["responseLogprobs"],f);let g=tc(t,["logprobs"]);null!=g&&td(s,["logprobs"],g);let y=tc(t,["presencePenalty"]);null!=y&&td(s,["presencePenalty"],y);let E=tc(t,["frequencyPenalty"]);null!=E&&td(s,["frequencyPenalty"],E);let _=tc(t,["seed"]);null!=_&&td(s,["seed"],_);let I=tc(t,["responseMimeType"]);null!=I&&td(s,["responseMimeType"],I);let v=tc(t,["responseSchema"]);null!=v&&td(s,["responseSchema"],t4(v));let T=tc(t,["responseJsonSchema"]);if(null!=T&&td(s,["responseJsonSchema"],T),void 0!==tc(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==tc(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let A=tc(t,["safetySettings"]);if(void 0!==n&&null!=A){let e=A;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["category"]);if(null!=n&&td(t,["category"],n),void 0!==tc(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=tc(e,["threshold"]);return null!=i&&td(t,["threshold"],i),t})(e))),td(n,["safetySettings"],e)}let C=tc(t,["tools"]);if(void 0!==n&&null!=C){let e=t7(C);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["functionDeclarations"],e)}if(void 0!==tc(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tc(e,["googleSearchRetrieval"]);null!=i&&td(t,["googleSearchRetrieval"],i);let l=tc(e,["computerUse"]);null!=l&&td(t,["computerUse"],l);let r=tc(e,["fileSearch"]);null!=r&&td(t,["fileSearch"],r);let o=tc(e,["codeExecution"]);if(null!=o&&td(t,["codeExecution"],o),void 0!==tc(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=tc(e,["googleMaps"]);null!=s&&td(t,["googleMaps"],function(e){let t={};if(void 0!==tc(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tc(e,["enableWidget"]);return null!=n&&td(t,["enableWidget"],n),t}(s));let a=tc(e,["googleSearch"]);null!=a&&td(t,["googleSearch"],function(e){let t={};if(void 0!==tc(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tc(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tc(e,["timeRangeFilter"]);return null!=n&&td(t,["timeRangeFilter"],n),t}(a));let u=tc(e,["urlContext"]);return null!=u&&td(t,["urlContext"],u),t})(t5(e)))),td(n,["tools"],e)}let S=tc(t,["toolConfig"]);if(void 0!==n&&null!=S&&td(n,["toolConfig"],(l={},null!=(r=tc(i=S,["functionCallingConfig"]))&&td(l,["functionCallingConfig"],function(e){let t={},n=tc(e,["mode"]);null!=n&&td(t,["mode"],n);let i=tc(e,["allowedFunctionNames"]);if(null!=i&&td(t,["allowedFunctionNames"],i),void 0!==tc(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(r)),null!=(o=tc(i,["retrievalConfig"]))&&td(l,["retrievalConfig"],o),l)),void 0!==tc(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let O=tc(t,["cachedContent"]);void 0!==n&&null!=O&&td(n,["cachedContent"],t8(e,O));let b=tc(t,["responseModalities"]);null!=b&&td(s,["responseModalities"],b);let N=tc(t,["mediaResolution"]);null!=N&&td(s,["mediaResolution"],N);let R=tc(t,["speechConfig"]);if(null!=R&&td(s,["speechConfig"],t6(R)),void 0!==tc(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let P=tc(t,["thinkingConfig"]);null!=P&&td(s,["thinkingConfig"],P);let x=tc(t,["imageConfig"]);return null!=x&&td(s,["imageConfig"],function(e){let t={},n=tc(e,["aspectRatio"]);null!=n&&td(t,["aspectRatio"],n);let i=tc(e,["imageSize"]);if(null!=i&&td(t,["imageSize"],i),void 0!==tc(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==tc(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(x)),s}(e,r,n)),n}function nN(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["_url","model"],tV(e,i));let l=tc(t,["contents"]);if(null!=l){let e=t2(l);Array.isArray(e)&&(e=e.map(e=>e)),td(n,["contents"],e)}let r=tc(t,["config"]);return null!=r&&td(n,["generationConfig"],function(e,t,n){var i;let l,r,o,s,a,u={},p=tc(t,["systemInstruction"]);void 0!==n&&null!=p&&td(n,["systemInstruction"],t0(p));let d=tc(t,["temperature"]);null!=d&&td(u,["temperature"],d);let c=tc(t,["topP"]);null!=c&&td(u,["topP"],c);let h=tc(t,["topK"]);null!=h&&td(u,["topK"],h);let m=tc(t,["candidateCount"]);null!=m&&td(u,["candidateCount"],m);let f=tc(t,["maxOutputTokens"]);null!=f&&td(u,["maxOutputTokens"],f);let g=tc(t,["stopSequences"]);null!=g&&td(u,["stopSequences"],g);let y=tc(t,["responseLogprobs"]);null!=y&&td(u,["responseLogprobs"],y);let E=tc(t,["logprobs"]);null!=E&&td(u,["logprobs"],E);let _=tc(t,["presencePenalty"]);null!=_&&td(u,["presencePenalty"],_);let I=tc(t,["frequencyPenalty"]);null!=I&&td(u,["frequencyPenalty"],I);let v=tc(t,["seed"]);null!=v&&td(u,["seed"],v);let T=tc(t,["responseMimeType"]);null!=T&&td(u,["responseMimeType"],T);let A=tc(t,["responseSchema"]);null!=A&&td(u,["responseSchema"],t4(A));let C=tc(t,["responseJsonSchema"]);null!=C&&td(u,["responseJsonSchema"],C);let S=tc(t,["routingConfig"]);null!=S&&td(u,["routingConfig"],S);let O=tc(t,["modelSelectionConfig"]);null!=O&&td(u,["modelConfig"],O);let b=tc(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>e)),td(n,["safetySettings"],e)}let N=tc(t,["tools"]);if(void 0!==n&&null!=N){let e=t7(N);Array.isArray(e)&&(e=e.map(e=>nj(t5(e)))),td(n,["tools"],e)}let R=tc(t,["toolConfig"]);void 0!==n&&null!=R&&td(n,["toolConfig"],R);let P=tc(t,["labels"]);void 0!==n&&null!=P&&td(n,["labels"],P);let x=tc(t,["cachedContent"]);void 0!==n&&null!=x&&td(n,["cachedContent"],t8(e,x));let D=tc(t,["responseModalities"]);null!=D&&td(u,["responseModalities"],D);let w=tc(t,["mediaResolution"]);null!=w&&td(u,["mediaResolution"],w);let M=tc(t,["speechConfig"]);null!=M&&td(u,["speechConfig"],nG(t6(M)));let U=tc(t,["audioTimestamp"]);null!=U&&td(u,["audioTimestamp"],U);let k=tc(t,["thinkingConfig"]);null!=k&&td(u,["thinkingConfig"],k);let L=tc(t,["imageConfig"]);return null!=L&&td(u,["imageConfig"],(l={},null!=(r=tc(i=L,["aspectRatio"]))&&td(l,["aspectRatio"],r),null!=(o=tc(i,["imageSize"]))&&td(l,["imageSize"],o),null!=(s=tc(i,["outputMimeType"]))&&td(l,["imageOutputOptions","mimeType"],s),null!=(a=tc(i,["outputCompressionQuality"]))&&td(l,["imageOutputOptions","compressionQuality"],a),l)),u}(e,r,n)),n}function nR(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["content"]);null!=n&&td(t,["content"],n);let i=tc(e,["citationMetadata"]);null!=i&&td(t,["citationMetadata"],function(e){let t={},n=tc(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["citations"],e)}return t}(i));let l=tc(e,["tokenCount"]);null!=l&&td(t,["tokenCount"],l);let r=tc(e,["finishReason"]);null!=r&&td(t,["finishReason"],r);let o=tc(e,["avgLogprobs"]);null!=o&&td(t,["avgLogprobs"],o);let s=tc(e,["groundingMetadata"]);null!=s&&td(t,["groundingMetadata"],s);let a=tc(e,["index"]);null!=a&&td(t,["index"],a);let u=tc(e,["logprobsResult"]);null!=u&&td(t,["logprobsResult"],u);let p=tc(e,["safetyRatings"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["safetyRatings"],e)}let d=tc(e,["urlContextMetadata"]);return null!=d&&td(t,["urlContextMetadata"],d),t})(e))),td(t,["candidates"],e)}let l=tc(e,["modelVersion"]);null!=l&&td(t,["modelVersion"],l);let r=tc(e,["promptFeedback"]);null!=r&&td(t,["promptFeedback"],r);let o=tc(e,["responseId"]);null!=o&&td(t,["responseId"],o);let s=tc(e,["usageMetadata"]);return null!=s&&td(t,["usageMetadata"],s),t}function nP(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["candidates"],e)}let l=tc(e,["createTime"]);null!=l&&td(t,["createTime"],l);let r=tc(e,["modelVersion"]);null!=r&&td(t,["modelVersion"],r);let o=tc(e,["promptFeedback"]);null!=o&&td(t,["promptFeedback"],o);let s=tc(e,["responseId"]);null!=s&&td(t,["responseId"],s);let a=tc(e,["usageMetadata"]);return null!=a&&td(t,["usageMetadata"],a),t}function nx(e){let t={},n=tc(e,["_self"]);null!=n&&td(t,["image"],nD(n));let i=tc(e,["raiFilteredReason"]);null!=i&&td(t,["raiFilteredReason"],i);let l=tc(e,["_self"]);null!=l&&td(t,["safetyAttributes"],nq(l));let r=tc(e,["prompt"]);return null!=r&&td(t,["enhancedPrompt"],r),t}function nD(e){let t={},n=tc(e,["gcsUri"]);null!=n&&td(t,["gcsUri"],n);let i=tc(e,["bytesBase64Encoded"]);null!=i&&td(t,["imageBytes"],th(i));let l=tc(e,["mimeType"]);return null!=l&&td(t,["mimeType"],l),t}function nw(e){let t={};if(void 0!==tc(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let n=tc(e,["imageBytes"]);null!=n&&td(t,["bytesBase64Encoded"],th(n));let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}function nM(e){let t={},n=tc(e,["gcsUri"]);null!=n&&td(t,["gcsUri"],n);let i=tc(e,["imageBytes"]);null!=i&&td(t,["bytesBase64Encoded"],th(i));let l=tc(e,["mimeType"]);return null!=l&&td(t,["mimeType"],l),t}function nU(e){var t;let n,i,l,r,o={},s=tc(e,["name"]);null!=s&&td(o,["name"],s);let a=tc(e,["displayName"]);null!=a&&td(o,["displayName"],a);let u=tc(e,["description"]);null!=u&&td(o,["description"],u);let p=tc(e,["version"]);null!=p&&td(o,["version"],p);let d=tc(e,["_self"]);null!=d&&td(o,["tunedModelInfo"],(n={},null!=(i=tc(t=d,["baseModel"]))&&td(n,["baseModel"],i),null!=(l=tc(t,["createTime"]))&&td(n,["createTime"],l),null!=(r=tc(t,["updateTime"]))&&td(n,["updateTime"],r),n));let c=tc(e,["inputTokenLimit"]);null!=c&&td(o,["inputTokenLimit"],c);let h=tc(e,["outputTokenLimit"]);null!=h&&td(o,["outputTokenLimit"],h);let m=tc(e,["supportedGenerationMethods"]);null!=m&&td(o,["supportedActions"],m);let f=tc(e,["temperature"]);null!=f&&td(o,["temperature"],f);let g=tc(e,["maxTemperature"]);null!=g&&td(o,["maxTemperature"],g);let y=tc(e,["topP"]);null!=y&&td(o,["topP"],y);let E=tc(e,["topK"]);null!=E&&td(o,["topK"],E);let _=tc(e,["thinking"]);return null!=_&&td(o,["thinking"],_),o}function nk(e){var t;let n,i,l,r,o={},s=tc(e,["name"]);null!=s&&td(o,["name"],s);let a=tc(e,["displayName"]);null!=a&&td(o,["displayName"],a);let u=tc(e,["description"]);null!=u&&td(o,["description"],u);let p=tc(e,["versionId"]);null!=p&&td(o,["version"],p);let d=tc(e,["deployedModels"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>{let t,n,i;return t={},null!=(n=tc(e,["endpoint"]))&&td(t,["name"],n),null!=(i=tc(e,["deployedModelId"]))&&td(t,["deployedModelId"],i),t})),td(o,["endpoints"],e)}let c=tc(e,["labels"]);null!=c&&td(o,["labels"],c);let h=tc(e,["_self"]);null!=h&&td(o,["tunedModelInfo"],(n={},null!=(i=tc(t=h,["labels","google-vertex-llm-tuning-base-model-id"]))&&td(n,["baseModel"],i),null!=(l=tc(t,["createTime"]))&&td(n,["createTime"],l),null!=(r=tc(t,["updateTime"]))&&td(n,["updateTime"],r),n));let m=tc(e,["defaultCheckpointId"]);null!=m&&td(o,["defaultCheckpointId"],m);let f=tc(e,["checkpoints"]);if(null!=f){let e=f;Array.isArray(e)&&(e=e.map(e=>e)),td(o,["checkpoints"],e)}return o}function nL(e){let t={},n=tc(e,["safetyAttributes","categories"]);null!=n&&td(t,["categories"],n);let i=tc(e,["safetyAttributes","scores"]);null!=i&&td(t,["scores"],i);let l=tc(e,["contentType"]);return null!=l&&td(t,["contentType"],l),t}function nq(e){let t={},n=tc(e,["safetyAttributes","categories"]);null!=n&&td(t,["categories"],n);let i=tc(e,["safetyAttributes","scores"]);null!=i&&td(t,["scores"],i);let l=tc(e,["contentType"]);return null!=l&&td(t,["contentType"],l),t}function nG(e){let t={},n=tc(e,["languageCode"]);null!=n&&td(t,["languageCode"],n);let i=tc(e,["voiceConfig"]);if(null!=i&&td(t,["voiceConfig"],i),void 0!==tc(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function nj(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tc(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=tc(e,["description"]);null!=n&&td(t,["description"],n);let i=tc(e,["name"]);null!=i&&td(t,["name"],i);let l=tc(e,["parameters"]);null!=l&&td(t,["parameters"],l);let r=tc(e,["parametersJsonSchema"]);null!=r&&td(t,["parametersJsonSchema"],r);let o=tc(e,["response"]);null!=o&&td(t,["response"],o);let s=tc(e,["responseJsonSchema"]);return null!=s&&td(t,["responseJsonSchema"],s),t})(e))),td(t,["functionDeclarations"],e)}let i=tc(e,["retrieval"]);null!=i&&td(t,["retrieval"],i);let l=tc(e,["googleSearchRetrieval"]);null!=l&&td(t,["googleSearchRetrieval"],l);let r=tc(e,["computerUse"]);if(null!=r&&td(t,["computerUse"],r),void 0!==tc(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tc(e,["codeExecution"]);null!=o&&td(t,["codeExecution"],o);let s=tc(e,["enterpriseWebSearch"]);null!=s&&td(t,["enterpriseWebSearch"],s);let a=tc(e,["googleMaps"]);null!=a&&td(t,["googleMaps"],a);let u=tc(e,["googleSearch"]);null!=u&&td(t,["googleSearch"],u);let p=tc(e,["urlContext"]);return null!=p&&td(t,["urlContext"],p),t}function nH(e){let t={},n=tc(e,["uri"]);null!=n&&td(t,["uri"],n);let i=tc(e,["videoBytes"]);null!=i&&td(t,["encodedVideo"],th(i));let l=tc(e,["mimeType"]);return null!=l&&td(t,["encoding"],l),t}function nF(e){let t={},n=tc(e,["uri"]);null!=n&&td(t,["gcsUri"],n);let i=tc(e,["videoBytes"]);null!=i&&td(t,["bytesBase64Encoded"],th(i));let l=tc(e,["mimeType"]);return null!=l&&td(t,["mimeType"],l),t}function nV(e,t){let n=tc(e,["mimeType"]);void 0!==t&&null!=n&&td(t,["mimeType"],n);let i=tc(e,["displayName"]);void 0!==t&&null!=i&&td(t,["displayName"],i);let l=tc(e,["customMetadata"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["customMetadata"],e)}let r=tc(e,["chunkingConfig"]);return void 0!==t&&null!=r&&td(t,["chunkingConfig"],r),{}}let nB="x-goog-api-client",nJ=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class nY{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=null!=(t=this.clientOptions.apiVersion)?t:"v1beta1",i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=null!=(n=this.clientOptions.apiVersion)?n:"v1beta",i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!=(e=this.clientOptions.vertexai)&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,n){let i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),""!==e&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(let[t,n]of Object.entries(e.queryParams))i.searchParams.append(t,String(n));let l={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,i.toString(),e.abortSignal),this.unaryApiCall(i,l,e.httpMethod)}patchHttpOptions(e,t){let n=JSON.parse(JSON.stringify(e));for(let[e,i]of Object.entries(t))"object"==typeof i?n[e]=Object.assign(Object.assign({},n[e]),i):void 0!==i&&(n[e]=i);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);i.searchParams.has("alt")&&"sse"===i.searchParams.get("alt")||i.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,i.toString(),e.abortSignal),this.streamApiCall(i,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){let n=new AbortController,l=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}i&&i.addEventListener("abort",()=>{n.abort()}),e.signal=l}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let n={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");n=t}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}e.body=JSON.stringify(function e(t,n){let i=Object.assign({},t);for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let l=n[t],r=i[t];l&&"object"==typeof l&&!Array.isArray(l)&&r&&"object"==typeof r&&!Array.isArray(r)?i[t]=e(r,l):(r&&l&&typeof r!=typeof l&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof r}, New type: ${typeof l}. Overwriting.`),i[t]=l)}return i}(n,t))}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await nW(e),new tf(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await nW(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){var t;return ng(this,arguments,function*(){let n=null==(t=null==e?void 0:e.body)?void 0:t.getReader(),i=new TextDecoder("utf-8");if(!n)throw Error("Response body is empty");try{let t="";for(;;){let{done:l,value:r}=yield nf(n.read());if(l){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let o=i.decode(r,{stream:!0});try{let e=JSON.parse(o);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),n=t.status,i=t.code,l=`got status: ${n}. ${JSON.stringify(e)}`;if(i>=400&&i<600)throw new nT({message:l,status:i})}}catch(e){if("ApiError"===e.name)throw e}let s=(t+=o).match(nJ);for(;s;){let n=s[1];try{let i=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield nf(new tf(i)),s=(t=t.slice(s[0].length)).match(nJ)}catch(e){throw Error(`exception parsing stream chunk ${n}. ${e}`)}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/1.31.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[nB]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){let n=new Headers;if(e&&e.headers){for(let[t,i]of Object.entries(e.headers))n.append(t,i);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"==typeof e&&(n=null!=(t=(n=e.replace(/[/\\]+$/,"")).split(/[/\\]/).pop())?t:""),n}async uploadFile(e,t){var n;let i={};null!=t&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);let l=this.clientOptions.uploader,r=await l.stat(e);i.sizeBytes=String(r.size);let o=null!=(n=null==t?void 0:t.mimeType)?n:r.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;let s={file:i},a=this.getFileName(e),u=tp("upload/v1beta/files",s._url),p=await this.fetchUploadUrl(u,i.sizeBytes,i.mimeType,a,s,null==t?void 0:t.httpOptions);return l.upload(e,p,this)}async uploadFileToFileSearchStore(e,t,n){var i;let l=this.clientOptions.uploader,r=await l.stat(t),o=String(r.size),s=null!=(i=null==n?void 0:n.mimeType)?i:r.type;if(void 0===s||""===s)throw Error("Can not determine mimeType. Please provide mimeType in the config.");let a=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(t),p={};null!=n&&nV(n,p);let d=await this.fetchUploadUrl(a,o,s,u,p,null==n?void 0:n.httpOptions);return l.uploadToFileSearchStore(t,d,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,i,l,r){var o;let s={};s=r||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};let a=await this.request({path:e,body:JSON.stringify(l),httpMethod:"POST",httpOptions:s});if(!a||!(null==a?void 0:a.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let u=null==(o=null==a?void 0:a.headers)?void 0:o["x-goog-upload-url"];if(void 0===u)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function nW(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let n=e.status,i=JSON.stringify((null==(t=e.headers.get("content-type"))?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(n>=400&&n<600)throw new nT({message:i,status:n});throw Error(i)}}function nK(e){for(let n of e){var t;if(null!==(t=n)&&"object"==typeof t&&t instanceof nz||"object"==typeof n&&"inputSchema"in n)return!0}return!1}function n$(e){var t;let n=null!=(t=e[nB])?t:"";e[nB]=(n+" mcp_used/unknown").trimStart()}class nz{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new nz(e,t)}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;let l={},r=[];for(let u of this.mcpClients)try{for(var o,s=!0,a=(t=void 0,ny(function(e,t=100){return ng(this,arguments,function*(){let n,i=0;for(;i<t;){let t=yield nf(e.listTools({cursor:n}));for(let e of t.tools)yield yield nf(e),i++;if(!t.nextCursor)break;n=t.nextCursor}})}(u)));!(e=(o=await a.next()).done);s=!0){i=o.value,s=!1,r.push(i);let e=i.name;if(l[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);l[e]=u}}catch(e){t={error:e}}finally{try{!s&&!e&&(n=a.return)&&await n.call(a)}finally{if(t)throw t.error}}this.mcpTools=r,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),function(e,t={}){let n=[],i=new Set;for(let l of e){let e=l.name;if(i.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i.add(e);let r=function(e,t={}){let n={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(n.responseJsonSchema=e.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}(l,t);r.functionDeclarations&&n.push(...r.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let n of e)if(n.name in this.functionNameToMcpClient){let e,i=this.functionNameToMcpClient[n.name];this.config.timeout&&(e={timeout:this.config.timeout});let l=await i.callTool({name:n.name,arguments:n.args},void 0,e);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}async function nX(e,t,n){let i=new tH;Object.assign(i,n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data)),t(i)}class nQ{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;let i;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let l=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t}(this.apiClient.getDefaultHeaders()),s=this.apiClient.getApiKey(),a=`${l}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${s}`,u=()=>{},p=new Promise(e=>{u=e}),d=e.callbacks,c=this.apiClient,h={onopen:function(){u({})},onmessage:e=>{nX(c,d.onmessage,e)},onerror:null!=(t=null==d?void 0:d.onerror)?t:function(e){},onclose:null!=(n=null==d?void 0:d.onclose)?n:function(e){}},m=this.webSocketFactory.create(a,(i={},o.forEach((e,t)=>{i[t]=e}),i),h);m.connect(),await p;let f=tV(this.apiClient,e.model);return m.send(JSON.stringify({setup:{model:f}})),new nZ(m,this.apiClient)}}class nZ{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=function(e){let t={},n=tc(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){let t,n;e.musicGenerationConfig||(e.musicGenerationConfig={});let i=(t={},null!=(n=tc(e,["musicGenerationConfig"]))&&td(t,["musicGenerationConfig"],n),t);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){this.conn.send(JSON.stringify({playbackControl:e}))}play(){this.sendPlaybackControl(e3.PLAY)}pause(){this.sendPlaybackControl(e3.PAUSE)}stop(){this.sendPlaybackControl(e3.STOP)}resetContext(){this.sendPlaybackControl(e3.RESET_CONTEXT)}close(){this.conn.close()}}async function n0(e,t,n){let i=new tj,l=JSON.parse(n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?new TextDecoder().decode(n.data):n.data);if(e.isVertexAI()){let e,t,n,r,o,s,a,u;Object.assign(i,(e={},null!=(t=tc(l,["setupComplete"]))&&td(e,["setupComplete"],t),null!=(n=tc(l,["serverContent"]))&&td(e,["serverContent"],n),null!=(r=tc(l,["toolCall"]))&&td(e,["toolCall"],r),null!=(o=tc(l,["toolCallCancellation"]))&&td(e,["toolCallCancellation"],o),null!=(s=tc(l,["usageMetadata"]))&&td(e,["usageMetadata"],function(e){let t={},n=tc(e,["promptTokenCount"]);null!=n&&td(t,["promptTokenCount"],n);let i=tc(e,["cachedContentTokenCount"]);null!=i&&td(t,["cachedContentTokenCount"],i);let l=tc(e,["candidatesTokenCount"]);null!=l&&td(t,["responseTokenCount"],l);let r=tc(e,["toolUsePromptTokenCount"]);null!=r&&td(t,["toolUsePromptTokenCount"],r);let o=tc(e,["thoughtsTokenCount"]);null!=o&&td(t,["thoughtsTokenCount"],o);let s=tc(e,["totalTokenCount"]);null!=s&&td(t,["totalTokenCount"],s);let a=tc(e,["promptTokensDetails"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["promptTokensDetails"],e)}let u=tc(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["cacheTokensDetails"],e)}let p=tc(e,["candidatesTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["responseTokensDetails"],e)}let d=tc(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["toolUsePromptTokensDetails"],e)}let c=tc(e,["trafficType"]);return null!=c&&td(t,["trafficType"],c),t}(s)),null!=(a=tc(l,["goAway"]))&&td(e,["goAway"],a),null!=(u=tc(l,["sessionResumptionUpdate"]))&&td(e,["sessionResumptionUpdate"],u),e))}else Object.assign(i,l);t(i)}class n1{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new nQ(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,l,r,o,s,a;let u,p;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let d=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),h=this.apiClient.getHeaders();e.config&&e.config.tools&&nK(e.config.tools)&&n$(h);let m=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t}(h);if(this.apiClient.isVertexAI())u=`${d}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,u);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==c&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),u=`${d}/ws/google.ai.generativelanguage.${c}.GenerativeService.${t}?${n}=${e}`}let f=()=>{},g=new Promise(e=>{f=e}),y=e.callbacks,E=this.apiClient,_={onopen:function(){var e;null==(e=null==y?void 0:y.onopen)||e.call(y),f({})},onmessage:e=>{n0(E,y.onmessage,e)},onerror:null!=(t=null==y?void 0:y.onerror)?t:function(e){},onclose:null!=(n=null==y?void 0:y.onclose)?n:function(e){}},I=this.webSocketFactory.create(u,(p={},m.forEach((e,t)=>{p[t]=e}),p),_);I.connect(),await g;let v=tV(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();v=`projects/${e}/locations/${t}/`+v}let T={};this.apiClient.isVertexAI()&&(null==(i=e.config)?void 0:i.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[eC.AUDIO]}:e.config.responseModalities=[eC.AUDIO]),(null==(l=e.config)?void 0:l.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let A=null!=(o=null==(r=e.config)?void 0:r.tools)?o:[],C=[];for(let e of A)this.isCallableTool(e)?C.push(await e.tool()):C.push(e);C.length>0&&(e.config.tools=C);let S={model:v,config:e.config,callbacks:e.callbacks};if(this.apiClient.isVertexAI()){let e,t,n;s=this.apiClient,e={},null!=(t=tc(S,["model"]))&&td(e,["setup","model"],tV(s,t)),null!=(n=tc(S,["config"]))&&td(e,["config"],function(e,t){let n=tc(e,["generationConfig"]);void 0!==t&&null!=n&&td(t,["setup","generationConfig"],function(e){let t={},n=tc(e,["modelSelectionConfig"]);null!=n&&td(t,["modelConfig"],n);let i=tc(e,["responseJsonSchema"]);null!=i&&td(t,["responseJsonSchema"],i);let l=tc(e,["audioTimestamp"]);null!=l&&td(t,["audioTimestamp"],l);let r=tc(e,["candidateCount"]);null!=r&&td(t,["candidateCount"],r);let o=tc(e,["enableAffectiveDialog"]);null!=o&&td(t,["enableAffectiveDialog"],o);let s=tc(e,["frequencyPenalty"]);null!=s&&td(t,["frequencyPenalty"],s);let a=tc(e,["logprobs"]);null!=a&&td(t,["logprobs"],a);let u=tc(e,["maxOutputTokens"]);null!=u&&td(t,["maxOutputTokens"],u);let p=tc(e,["mediaResolution"]);null!=p&&td(t,["mediaResolution"],p);let d=tc(e,["presencePenalty"]);null!=d&&td(t,["presencePenalty"],d);let c=tc(e,["responseLogprobs"]);null!=c&&td(t,["responseLogprobs"],c);let h=tc(e,["responseMimeType"]);null!=h&&td(t,["responseMimeType"],h);let m=tc(e,["responseModalities"]);null!=m&&td(t,["responseModalities"],m);let f=tc(e,["responseSchema"]);null!=f&&td(t,["responseSchema"],f);let g=tc(e,["routingConfig"]);null!=g&&td(t,["routingConfig"],g);let y=tc(e,["seed"]);null!=y&&td(t,["seed"],y);let E=tc(e,["speechConfig"]);null!=E&&td(t,["speechConfig"],nS(E));let _=tc(e,["stopSequences"]);null!=_&&td(t,["stopSequences"],_);let I=tc(e,["temperature"]);null!=I&&td(t,["temperature"],I);let v=tc(e,["thinkingConfig"]);null!=v&&td(t,["thinkingConfig"],v);let T=tc(e,["topK"]);null!=T&&td(t,["topK"],T);let A=tc(e,["topP"]);if(null!=A&&td(t,["topP"],A),void 0!==tc(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));let i=tc(e,["responseModalities"]);void 0!==t&&null!=i&&td(t,["setup","generationConfig","responseModalities"],i);let l=tc(e,["temperature"]);void 0!==t&&null!=l&&td(t,["setup","generationConfig","temperature"],l);let r=tc(e,["topP"]);void 0!==t&&null!=r&&td(t,["setup","generationConfig","topP"],r);let o=tc(e,["topK"]);void 0!==t&&null!=o&&td(t,["setup","generationConfig","topK"],o);let s=tc(e,["maxOutputTokens"]);void 0!==t&&null!=s&&td(t,["setup","generationConfig","maxOutputTokens"],s);let a=tc(e,["mediaResolution"]);void 0!==t&&null!=a&&td(t,["setup","generationConfig","mediaResolution"],a);let u=tc(e,["seed"]);void 0!==t&&null!=u&&td(t,["setup","generationConfig","seed"],u);let p=tc(e,["speechConfig"]);void 0!==t&&null!=p&&td(t,["setup","generationConfig","speechConfig"],nS(t3(p)));let d=tc(e,["thinkingConfig"]);void 0!==t&&null!=d&&td(t,["setup","generationConfig","thinkingConfig"],d);let c=tc(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&td(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=tc(e,["systemInstruction"]);void 0!==t&&null!=h&&td(t,["setup","systemInstruction"],t0(h));let m=tc(e,["tools"]);if(void 0!==t&&null!=m){let e=t7(m);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==tc(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=tc(e,["description"]);null!=n&&td(t,["description"],n);let i=tc(e,["name"]);null!=i&&td(t,["name"],i);let l=tc(e,["parameters"]);null!=l&&td(t,["parameters"],l);let r=tc(e,["parametersJsonSchema"]);null!=r&&td(t,["parametersJsonSchema"],r);let o=tc(e,["response"]);null!=o&&td(t,["response"],o);let s=tc(e,["responseJsonSchema"]);return null!=s&&td(t,["responseJsonSchema"],s),t})(e))),td(t,["functionDeclarations"],e)}let i=tc(e,["retrieval"]);null!=i&&td(t,["retrieval"],i);let l=tc(e,["googleSearchRetrieval"]);null!=l&&td(t,["googleSearchRetrieval"],l);let r=tc(e,["computerUse"]);if(null!=r&&td(t,["computerUse"],r),void 0!==tc(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=tc(e,["codeExecution"]);null!=o&&td(t,["codeExecution"],o);let s=tc(e,["enterpriseWebSearch"]);null!=s&&td(t,["enterpriseWebSearch"],s);let a=tc(e,["googleMaps"]);null!=a&&td(t,["googleMaps"],a);let u=tc(e,["googleSearch"]);null!=u&&td(t,["googleSearch"],u);let p=tc(e,["urlContext"]);return null!=p&&td(t,["urlContext"],p),t})(t5(e)))),td(t,["setup","tools"],e)}let f=tc(e,["sessionResumption"]);void 0!==t&&null!=f&&td(t,["setup","sessionResumption"],f);let g=tc(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&td(t,["setup","inputAudioTranscription"],g);let y=tc(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&td(t,["setup","outputAudioTranscription"],y);let E=tc(e,["realtimeInputConfig"]);void 0!==t&&null!=E&&td(t,["setup","realtimeInputConfig"],E);let _=tc(e,["contextWindowCompression"]);void 0!==t&&null!=_&&td(t,["setup","contextWindowCompression"],_);let I=tc(e,["proactivity"]);return void 0!==t&&null!=I&&td(t,["setup","proactivity"],I),{}}(n,e)),T=e}else{let e,t,n;a=this.apiClient,e={},null!=(t=tc(S,["model"]))&&td(e,["setup","model"],tV(a,t)),null!=(n=tc(S,["config"]))&&td(e,["config"],function(e,t){let n=tc(e,["generationConfig"]);void 0!==t&&null!=n&&td(t,["setup","generationConfig"],n);let i=tc(e,["responseModalities"]);void 0!==t&&null!=i&&td(t,["setup","generationConfig","responseModalities"],i);let l=tc(e,["temperature"]);void 0!==t&&null!=l&&td(t,["setup","generationConfig","temperature"],l);let r=tc(e,["topP"]);void 0!==t&&null!=r&&td(t,["setup","generationConfig","topP"],r);let o=tc(e,["topK"]);void 0!==t&&null!=o&&td(t,["setup","generationConfig","topK"],o);let s=tc(e,["maxOutputTokens"]);void 0!==t&&null!=s&&td(t,["setup","generationConfig","maxOutputTokens"],s);let a=tc(e,["mediaResolution"]);void 0!==t&&null!=a&&td(t,["setup","generationConfig","mediaResolution"],a);let u=tc(e,["seed"]);void 0!==t&&null!=u&&td(t,["setup","generationConfig","seed"],u);let p=tc(e,["speechConfig"]);void 0!==t&&null!=p&&td(t,["setup","generationConfig","speechConfig"],t3(p));let d=tc(e,["thinkingConfig"]);void 0!==t&&null!=d&&td(t,["setup","generationConfig","thinkingConfig"],d);let c=tc(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&td(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=tc(e,["systemInstruction"]);void 0!==t&&null!=h&&td(t,["setup","systemInstruction"],function(e){let t={},n=tc(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s,a,u,p,d,c,h;return n={},null!=(i=tc(t=e,["mediaResolution"]))&&td(n,["mediaResolution"],i),null!=(l=tc(t,["codeExecutionResult"]))&&td(n,["codeExecutionResult"],l),null!=(r=tc(t,["executableCode"]))&&td(n,["executableCode"],r),null!=(o=tc(t,["fileData"]))&&td(n,["fileData"],function(e){let t={};if(void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tc(e,["fileUri"]);null!=n&&td(t,["fileUri"],n);let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(o)),null!=(s=tc(t,["functionCall"]))&&td(n,["functionCall"],function(e){let t={},n=tc(e,["id"]);null!=n&&td(t,["id"],n);let i=tc(e,["args"]);null!=i&&td(t,["args"],i);let l=tc(e,["name"]);if(null!=l&&td(t,["name"],l),void 0!==tc(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tc(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=tc(t,["functionResponse"]))&&td(n,["functionResponse"],a),null!=(u=tc(t,["inlineData"]))&&td(n,["inlineData"],nC(u)),null!=(p=tc(t,["text"]))&&td(n,["text"],p),null!=(d=tc(t,["thought"]))&&td(n,["thought"],d),null!=(c=tc(t,["thoughtSignature"]))&&td(n,["thoughtSignature"],c),null!=(h=tc(t,["videoMetadata"]))&&td(n,["videoMetadata"],h),n})),td(t,["parts"],e)}let i=tc(e,["role"]);return null!=i&&td(t,["role"],i),t}(t0(h)));let m=tc(e,["tools"]);if(void 0!==t&&null!=m){let e=t7(m);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["functionDeclarations"],e)}if(void 0!==tc(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tc(e,["googleSearchRetrieval"]);null!=i&&td(t,["googleSearchRetrieval"],i);let l=tc(e,["computerUse"]);null!=l&&td(t,["computerUse"],l);let r=tc(e,["fileSearch"]);null!=r&&td(t,["fileSearch"],r);let o=tc(e,["codeExecution"]);if(null!=o&&td(t,["codeExecution"],o),void 0!==tc(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=tc(e,["googleMaps"]);null!=s&&td(t,["googleMaps"],function(e){let t={};if(void 0!==tc(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tc(e,["enableWidget"]);return null!=n&&td(t,["enableWidget"],n),t}(s));let a=tc(e,["googleSearch"]);null!=a&&td(t,["googleSearch"],function(e){let t={};if(void 0!==tc(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tc(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tc(e,["timeRangeFilter"]);return null!=n&&td(t,["timeRangeFilter"],n),t}(a));let u=tc(e,["urlContext"]);return null!=u&&td(t,["urlContext"],u),t})(t5(e)))),td(t,["setup","tools"],e)}let f=tc(e,["sessionResumption"]);void 0!==t&&null!=f&&td(t,["setup","sessionResumption"],function(e){let t={},n=tc(e,["handle"]);if(null!=n&&td(t,["handle"],n),void 0!==tc(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(f));let g=tc(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&td(t,["setup","inputAudioTranscription"],g);let y=tc(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&td(t,["setup","outputAudioTranscription"],y);let E=tc(e,["realtimeInputConfig"]);void 0!==t&&null!=E&&td(t,["setup","realtimeInputConfig"],E);let _=tc(e,["contextWindowCompression"]);void 0!==t&&null!=_&&td(t,["setup","contextWindowCompression"],_);let I=tc(e,["proactivity"]);return void 0!==t&&null!=I&&td(t,["setup","proactivity"],I),{}}(n,e)),T=e}return delete T.config,I.send(JSON.stringify(T)),new n4(I,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}let n2={turnComplete:!0};class n4{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=t2(t.turns),e.isVertexAI()||(n=n.map(e=>nO(e)))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses||0===(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},n2),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},n=tc(e,["media"]);if(null!=n){let e=tJ(n);Array.isArray(e)&&(e=e.map(e=>e)),td(t,["mediaChunks"],e)}let i=tc(e,["audio"]);null!=i&&td(t,["audio"],tK(i));let l=tc(e,["audioStreamEnd"]);null!=l&&td(t,["audioStreamEnd"],l);let r=tc(e,["video"]);null!=r&&td(t,["video"],tW(r));let o=tc(e,["text"]);null!=o&&td(t,["text"],o);let s=tc(e,["activityStart"]);null!=s&&td(t,["activityStart"],s);let a=tc(e,["activityEnd"]);return null!=a&&td(t,["activityEnd"],a),t}(e)}:{realtimeInput:function(e){let t={},n=tc(e,["media"]);if(null!=n){let e=tJ(n);Array.isArray(e)&&(e=e.map(e=>nC(e))),td(t,["mediaChunks"],e)}let i=tc(e,["audio"]);null!=i&&td(t,["audio"],nC(tK(i)));let l=tc(e,["audioStreamEnd"]);null!=l&&td(t,["audioStreamEnd"],l);let r=tc(e,["video"]);null!=r&&td(t,["video"],nC(tW(r)));let o=tc(e,["text"]);null!=o&&td(t,["text"],o);let s=tc(e,["activityStart"]);null!=s&&td(t,["activityStart"],s);let a=tc(e,["activityEnd"]);return null!=a&&td(t,["activityEnd"],a),t}(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function n6(e){var t,n,i;if(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.disable)return!0;let l=!1;for(let t of null!=(n=null==e?void 0:e.tools)?n:[])if(n3(t)){l=!0;break}if(!l)return!0;let r=null==(i=null==e?void 0:e.automaticFunctionCalling)?void 0:i.maximumRemoteCalls;return(!(!r||!(r<0)&&Number.isInteger(r))||0==r)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0)}function n3(e){return"callTool"in e&&"function"==typeof e.callTool}function n5(e){var t;let n=[];return(null==(t=null==e?void 0:e.config)?void 0:t.tools)&&e.config.tools.forEach((e,t)=>{n3(e)||e.functionDeclarations&&e.functionDeclarations.length>0&&n.push(t)}),n}function n7(e){var t;return!(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.ignoreCallHistory)}class n8 extends tu{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,i,l,r,o,s,a;let u,p,d=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!(null!=(a=null==(s=null==(o=e.config)?void 0:o.tools)?void 0:s.some(e=>n3(e)))&&a)||n6(e.config))return await this.generateContentInternal(d);let c=n5(e);if(c.length>0){let e=c.map(e=>`tools[${e}]`).join(", ");throw Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`)}let h=t2(d.contents),m=null!=(i=null==(n=null==(t=d.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?i:10,f=0;for(;f<m&&(u=await this.generateContentInternal(d)).functionCalls&&0!==u.functionCalls.length;){let t=u.candidates[0].content,n=[];for(let t of null!=(r=null==(l=e.config)?void 0:l.tools)?r:[])if(n3(t)){let e=await t.callTool(u.functionCalls);n.push(...e)}f++,p={role:"user",parts:n},d.contents=t2(d.contents),d.contents.push(t),d.contents.push(p),n7(d.config)&&(h.push(t),h.push(p))}return n7(d.config)&&(u.automaticFunctionCallingHistory=h),u},this.generateContentStream=async e=>{var t,n,i,l,r;if(this.maybeMoveToResponseJsonSchem(e),n6(e.config)){let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}let o=n5(e);if(o.length>0){let e=o.map(e=>`tools[${e}]`).join(", ");throw Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let s=null==(i=null==(n=null==(t=null==e?void 0:e.config)?void 0:t.toolConfig)?void 0:n.functionCallingConfig)?void 0:i.streamFunctionCallArguments,a=null==(r=null==(l=null==e?void 0:e.config)?void 0:l.automaticFunctionCalling)?void 0:r.disable;if(s&&!a)throw Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n,i=[];if(null==e?void 0:e.generatedImages)for(let l of e.generatedImages)l&&(null==l?void 0:l.safetyAttributes)&&(null==(t=null==l?void 0:l.safetyAttributes)?void 0:t.contentType)==="Positive Prompt"?n=null==l?void 0:l.safetyAttributes:i.push(l);return n?{generatedImages:i,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:i,sdkHttpResponse:e.sdkHttpResponse}}),this.list=async e=>{var t;let n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase)if(null==(t=n.config)?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else n.config.filter="labels.tune-type:*";return new nd(e5.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,i,l,r,o;if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null==(t=e.video)?void 0:t.uri)&&(null==(n=e.video)?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null==(l=null==(i=e.source)?void 0:i.video)?void 0:l.uri)&&(null==(o=null==(r=e.source)?void 0:r.video)?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema)}async processParamsMaybeAddMcpUsage(e){var t,n,i;let l=null==(t=e.config)?void 0:t.tools;if(!l)return e;let r=await Promise.all(l.map(async e=>n3(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:r})};if(o.config.tools=r,e.config&&e.config.tools&&nK(e.config.tools)){let t=Object.assign({},null!=(i=null==(n=e.config.httpOptions)?void 0:n.headers)?i:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),n$(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t})}return o}async initAfcToolsMap(e){var t,n,i;let l=new Map;for(let r of null!=(n=null==(t=e.config)?void 0:t.tools)?n:[])if(n3(r))for(let e of null!=(i=(await r.tool()).functionDeclarations)?i:[]){if(!e.name)throw Error("Function declaration name is required.");if(l.has(e.name))throw Error(`Duplicate tool declaration name: ${e.name}`);l.set(e.name,r)}return l}async processAfcStream(e){var t,n,i;let l=null!=(i=null==(n=null==(t=e.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?i:10,r=!1,o=0;return function(e,t,n){var i,s;return ng(this,arguments,function*(){for(var a,u,p,d;o<l;){r&&(o++,r=!1);let f=yield nf(e.processParamsMaybeAddMcpUsage(n)),g=yield nf(e.generateContentStreamInternal(f)),y=[],E=[];try{for(var c,h=!0,m=(u=void 0,ny(g));!(a=(c=yield nf(m.next())).done);h=!0)if(d=c.value,h=!1,yield yield nf(d),d.candidates&&(null==(i=d.candidates[0])?void 0:i.content)){for(let e of(E.push(d.candidates[0].content),null!=(s=d.candidates[0].content.parts)?s:[]))if(o<l&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let n=yield nf(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...n)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`)}}}catch(e){u={error:e}}finally{try{!h&&!a&&(p=m.return)&&(yield nf(p.call(m)))}finally{if(u)throw u.error}}if(y.length>0){r=!0;let e=new tg;e.candidates=[{content:{role:"user",parts:y}}],yield yield nf(e);let t=[];t.push(...E),t.push({role:"user",parts:y});let i=t2(n.contents).concat(t);n.contents=i}else break}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=nN(this.apiClient,e);return r=tp("{model}:generateContent",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=nP(e),n=new tg;return Object.assign(n,t),n})}{let t=nb(this.apiClient,e);return r=tp("{model}:generateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=nR(e),n=new tg;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=nN(this.apiClient,e);return r=tp("{model}:streamGenerateContent?alt=sse",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.requestStream({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(function(e){return ng(this,arguments,function*(){var t,n,i,l;try{for(var r,o=!0,s=ny(e);!(t=(r=yield nf(s.next())).done);o=!0){l=r.value,o=!1;let e=nP((yield nf(l.json())));e.sdkHttpResponse={headers:l.headers};let t=new tg;Object.assign(t,e),yield yield nf(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(i=s.return)&&(yield nf(i.call(s)))}finally{if(n)throw n.error}}})})}{let t=nb(this.apiClient,e);return r=tp("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.requestStream({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(function(e){return ng(this,arguments,function*(){var t,n,i,l;try{for(var r,o=!0,s=ny(e);!(t=(r=yield nf(s.next())).done);o=!0){l=r.value,o=!1;let e=nR((yield nf(l.json())));e.sdkHttpResponse={headers:l.headers};let t=new tg;Object.assign(t,e),yield yield nf(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(i=s.return)&&(yield nf(i.call(s)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n,i,l,r,o,s={},a=tc(t,["model"]);null!=a&&td(s,["_url","model"],tV(e,a));let u=tc(t,["contents"]);if(null!=u){let t=t1(e,u);Array.isArray(t)&&(t=t.map(e=>e)),td(s,["instances[]","content"],t)}let p=tc(t,["config"]);return null!=p&&(n=tc(p,["taskType"]),void 0!==s&&null!=n&&td(s,["instances[]","task_type"],n),i=tc(p,["title"]),void 0!==s&&null!=i&&td(s,["instances[]","title"],i),l=tc(p,["outputDimensionality"]),void 0!==s&&null!=l&&td(s,["parameters","outputDimensionality"],l),r=tc(p,["mimeType"]),void 0!==s&&null!=r&&td(s,["instances[]","mimeType"],r),o=tc(p,["autoTruncate"]),void 0!==s&&null!=o&&td(s,["parameters","autoTruncate"],o)),s}(this.apiClient,e);return r=tp("{model}:predict",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["predictions[]","embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s;return n={},null!=(i=tc(e,["values"]))&&td(n,["values"],i),null!=(l=tc(e,["statistics"]))&&td(n,["statistics"],(r={},null!=(o=tc(t=l,["truncated"]))&&td(r,["truncated"],o),null!=(s=tc(t,["token_count"]))&&td(r,["tokenCount"],s),r)),n})),td(t,["embeddings"],e)}let l=tc(e,["metadata"]);return null!=l&&td(t,["metadata"],l),t}(e),n=new ty;return Object.assign(n,t),n})}{let t=function(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["_url","model"],tV(e,i));let l=tc(t,["contents"]);if(null!=l){let t=t1(e,l);Array.isArray(t)&&(t=t.map(e=>e)),td(n,["requests[]","content"],t)}let r=tc(t,["config"]);null!=r&&function(e,t){let n=tc(e,["taskType"]);void 0!==t&&null!=n&&td(t,["requests[]","taskType"],n);let i=tc(e,["title"]);void 0!==t&&null!=i&&td(t,["requests[]","title"],i);let l=tc(e,["outputDimensionality"]);if(void 0!==t&&null!=l&&td(t,["requests[]","outputDimensionality"],l),void 0!==tc(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==tc(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(r,n);let o=tc(t,["model"]);return void 0!==o&&td(n,["requests[]","model"],tV(e,o)),n}(this.apiClient,e);return r=tp("{model}:batchEmbedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["embeddings"],e)}let l=tc(e,["metadata"]);return null!=l&&td(t,["metadata"],l),t}(e),n=new ty;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d,c,h,m,f,g,y,E,_,I,v,T,A,C,S,O,b=(r=this.apiClient,i={},null!=(l=tc(e,["model"]))&&td(i,["_url","model"],tV(r,l)),null!=(o=tc(e,["prompt"]))&&td(i,["instances[0]","prompt"],o),null!=(u=tc(e,["config"]))&&(p=tc(u,["outputGcsUri"]),void 0!==i&&null!=p&&td(i,["parameters","storageUri"],p),d=tc(u,["negativePrompt"]),void 0!==i&&null!=d&&td(i,["parameters","negativePrompt"],d),c=tc(u,["numberOfImages"]),void 0!==i&&null!=c&&td(i,["parameters","sampleCount"],c),h=tc(u,["aspectRatio"]),void 0!==i&&null!=h&&td(i,["parameters","aspectRatio"],h),m=tc(u,["guidanceScale"]),void 0!==i&&null!=m&&td(i,["parameters","guidanceScale"],m),f=tc(u,["seed"]),void 0!==i&&null!=f&&td(i,["parameters","seed"],f),g=tc(u,["safetyFilterLevel"]),void 0!==i&&null!=g&&td(i,["parameters","safetySetting"],g),y=tc(u,["personGeneration"]),void 0!==i&&null!=y&&td(i,["parameters","personGeneration"],y),E=tc(u,["includeSafetyAttributes"]),void 0!==i&&null!=E&&td(i,["parameters","includeSafetyAttributes"],E),_=tc(u,["includeRaiReason"]),void 0!==i&&null!=_&&td(i,["parameters","includeRaiReason"],_),I=tc(u,["language"]),void 0!==i&&null!=I&&td(i,["parameters","language"],I),v=tc(u,["outputMimeType"]),void 0!==i&&null!=v&&td(i,["parameters","outputOptions","mimeType"],v),T=tc(u,["outputCompressionQuality"]),void 0!==i&&null!=T&&td(i,["parameters","outputOptions","compressionQuality"],T),A=tc(u,["addWatermark"]),void 0!==i&&null!=A&&td(i,["parameters","addWatermark"],A),C=tc(u,["labels"]),void 0!==i&&null!=C&&td(i,["labels"],C),S=tc(u,["imageSize"]),void 0!==i&&null!=S&&td(i,["parameters","sampleImageSize"],S),O=tc(u,["enhancePrompt"]),void 0!==i&&null!=O&&td(i,["parameters","enhancePrompt"],O)),i);return s=tp("{model}:predict",b._url),a=b._query,delete b._url,delete b._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nx(e))),td(t,["generatedImages"],e)}let l=tc(e,["positivePromptSafetyAttributes"]);return null!=l&&td(t,["positivePromptSafetyAttributes"],nq(l)),t}(e),n=new tE;return Object.assign(n,t),n})}{let t,n,r,u,p=(o=this.apiClient,t={},null!=(n=tc(e,["model"]))&&td(t,["_url","model"],tV(o,n)),null!=(r=tc(e,["prompt"]))&&td(t,["instances[0]","prompt"],r),null!=(u=tc(e,["config"]))&&function(e,t){if(void 0!==tc(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==tc(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let n=tc(e,["numberOfImages"]);void 0!==t&&null!=n&&td(t,["parameters","sampleCount"],n);let i=tc(e,["aspectRatio"]);void 0!==t&&null!=i&&td(t,["parameters","aspectRatio"],i);let l=tc(e,["guidanceScale"]);if(void 0!==t&&null!=l&&td(t,["parameters","guidanceScale"],l),void 0!==tc(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let r=tc(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&td(t,["parameters","safetySetting"],r);let o=tc(e,["personGeneration"]);void 0!==t&&null!=o&&td(t,["parameters","personGeneration"],o);let s=tc(e,["includeSafetyAttributes"]);void 0!==t&&null!=s&&td(t,["parameters","includeSafetyAttributes"],s);let a=tc(e,["includeRaiReason"]);void 0!==t&&null!=a&&td(t,["parameters","includeRaiReason"],a);let u=tc(e,["language"]);void 0!==t&&null!=u&&td(t,["parameters","language"],u);let p=tc(e,["outputMimeType"]);void 0!==t&&null!=p&&td(t,["parameters","outputOptions","mimeType"],p);let d=tc(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&td(t,["parameters","outputOptions","compressionQuality"],d),void 0!==tc(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==tc(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let c=tc(e,["imageSize"]);if(void 0!==t&&null!=c&&td(t,["parameters","sampleImageSize"],c),void 0!==tc(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(u,t),t);return s=tp("{model}:predict",p._url),a=p._query,delete p._url,delete p._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>{var t,n;let i,l,r,o,s,a,u;return i={},null!=(l=tc(t=e,["_self"]))&&td(i,["image"],(r={},null!=(o=tc(n=l,["bytesBase64Encoded"]))&&td(r,["imageBytes"],th(o)),null!=(s=tc(n,["mimeType"]))&&td(r,["mimeType"],s),r)),null!=(a=tc(t,["raiFilteredReason"]))&&td(i,["raiFilteredReason"],a),null!=(u=tc(t,["_self"]))&&td(i,["safetyAttributes"],nL(u)),i})),td(t,["generatedImages"],e)}let l=tc(e,["positivePromptSafetyAttributes"]);return null!=l&&td(t,["positivePromptSafetyAttributes"],nL(l)),t}(e),n=new tE;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n,i,l,r,o,s,a,u,p,d,c,h,m,f,g,y,E,_={},I=tc(t,["model"]);null!=I&&td(_,["_url","model"],tV(e,I));let v=tc(t,["prompt"]);null!=v&&td(_,["instances[0]","prompt"],v);let T=tc(t,["referenceImages"]);if(null!=T){let e=T;Array.isArray(e)&&(e=e.map(e=>(function(e){let t,n,i,l,r,o,s,a={},u=tc(e,["referenceImage"]);null!=u&&td(a,["referenceImage"],nM(u));let p=tc(e,["referenceId"]);null!=p&&td(a,["referenceId"],p);let d=tc(e,["referenceType"]);null!=d&&td(a,["referenceType"],d);let c=tc(e,["maskImageConfig"]);null!=c&&td(a,["maskImageConfig"],(t={},null!=(n=tc(c,["maskMode"]))&&td(t,["maskMode"],n),null!=(i=tc(c,["segmentationClasses"]))&&td(t,["maskClasses"],i),null!=(l=tc(c,["maskDilation"]))&&td(t,["dilation"],l),t));let h=tc(e,["controlImageConfig"]);null!=h&&td(a,["controlImageConfig"],(r={},null!=(o=tc(h,["controlType"]))&&td(r,["controlType"],o),null!=(s=tc(h,["enableControlImageComputation"]))&&td(r,["computeControl"],s),r));let m=tc(e,["styleImageConfig"]);null!=m&&td(a,["styleImageConfig"],m);let f=tc(e,["subjectImageConfig"]);return null!=f&&td(a,["subjectImageConfig"],f),a})(e))),td(_,["instances[0]","referenceImages"],e)}let A=tc(t,["config"]);return null!=A&&(n=tc(A,["outputGcsUri"]),void 0!==_&&null!=n&&td(_,["parameters","storageUri"],n),i=tc(A,["negativePrompt"]),void 0!==_&&null!=i&&td(_,["parameters","negativePrompt"],i),l=tc(A,["numberOfImages"]),void 0!==_&&null!=l&&td(_,["parameters","sampleCount"],l),r=tc(A,["aspectRatio"]),void 0!==_&&null!=r&&td(_,["parameters","aspectRatio"],r),o=tc(A,["guidanceScale"]),void 0!==_&&null!=o&&td(_,["parameters","guidanceScale"],o),s=tc(A,["seed"]),void 0!==_&&null!=s&&td(_,["parameters","seed"],s),a=tc(A,["safetyFilterLevel"]),void 0!==_&&null!=a&&td(_,["parameters","safetySetting"],a),u=tc(A,["personGeneration"]),void 0!==_&&null!=u&&td(_,["parameters","personGeneration"],u),p=tc(A,["includeSafetyAttributes"]),void 0!==_&&null!=p&&td(_,["parameters","includeSafetyAttributes"],p),d=tc(A,["includeRaiReason"]),void 0!==_&&null!=d&&td(_,["parameters","includeRaiReason"],d),c=tc(A,["language"]),void 0!==_&&null!=c&&td(_,["parameters","language"],c),h=tc(A,["outputMimeType"]),void 0!==_&&null!=h&&td(_,["parameters","outputOptions","mimeType"],h),m=tc(A,["outputCompressionQuality"]),void 0!==_&&null!=m&&td(_,["parameters","outputOptions","compressionQuality"],m),f=tc(A,["addWatermark"]),void 0!==_&&null!=f&&td(_,["parameters","addWatermark"],f),g=tc(A,["labels"]),void 0!==_&&null!=g&&td(_,["labels"],g),y=tc(A,["editMode"]),void 0!==_&&null!=y&&td(_,["parameters","editMode"],y),E=tc(A,["baseSteps"]),void 0!==_&&null!=E&&td(_,["parameters","editConfig","baseSteps"],E)),_}(this.apiClient,e);return i=tp("{model}:predict",r._url),l=r._query,delete r._url,delete r._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nx(e))),td(t,["generatedImages"],e)}return t}(e),n=new t_;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n,i;let l="",r={};if(this.apiClient.isVertexAI()){let o,s,a,u,p,d,c,h,m,f,g,y,E,_,I,v,T=(i=this.apiClient,o={},null!=(s=tc(e,["model"]))&&td(o,["_url","model"],tV(i,s)),null!=(a=tc(e,["image"]))&&td(o,["instances[0]","image"],nM(a)),null!=(u=tc(e,["upscaleFactor"]))&&td(o,["parameters","upscaleConfig","upscaleFactor"],u),null!=(p=tc(e,["config"]))&&(d=tc(p,["outputGcsUri"]),void 0!==o&&null!=d&&td(o,["parameters","storageUri"],d),c=tc(p,["safetyFilterLevel"]),void 0!==o&&null!=c&&td(o,["parameters","safetySetting"],c),h=tc(p,["personGeneration"]),void 0!==o&&null!=h&&td(o,["parameters","personGeneration"],h),m=tc(p,["includeRaiReason"]),void 0!==o&&null!=m&&td(o,["parameters","includeRaiReason"],m),f=tc(p,["outputMimeType"]),void 0!==o&&null!=f&&td(o,["parameters","outputOptions","mimeType"],f),g=tc(p,["outputCompressionQuality"]),void 0!==o&&null!=g&&td(o,["parameters","outputOptions","compressionQuality"],g),y=tc(p,["enhanceInputImage"]),void 0!==o&&null!=y&&td(o,["parameters","upscaleConfig","enhanceInputImage"],y),E=tc(p,["imagePreservationFactor"]),void 0!==o&&null!=E&&td(o,["parameters","upscaleConfig","imagePreservationFactor"],E),_=tc(p,["labels"]),void 0!==o&&null!=_&&td(o,["labels"],_),I=tc(p,["numberOfImages"]),void 0!==o&&null!=I&&td(o,["parameters","sampleCount"],I),v=tc(p,["mode"]),void 0!==o&&null!=v&&td(o,["parameters","mode"],v)),o);return l=tp("{model}:predict",T._url),r=T._query,delete T._url,delete T._query,this.apiClient.request({path:l,queryParams:r,body:JSON.stringify(T),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nx(e))),td(t,["generatedImages"],e)}return t}(e),n=new tI;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n,i;let l="",r={};if(this.apiClient.isVertexAI()){let o,s,a,u,p,d,c,h,m,f,g,y,E,_,I,v=(i=this.apiClient,o={},null!=(s=tc(e,["model"]))&&td(o,["_url","model"],tV(i,s)),null!=(a=tc(e,["source"]))&&function(e,t){let n=tc(e,["prompt"]);void 0!==t&&null!=n&&td(t,["instances[0]","prompt"],n);let i=tc(e,["personImage"]);void 0!==t&&null!=i&&td(t,["instances[0]","personImage","image"],nM(i));let l=tc(e,["productImages"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>{let t,n;return t={},null!=(n=tc(e,["productImage"]))&&td(t,["image"],nM(n)),t})),td(t,["instances[0]","productImages"],e)}}(a,o),null!=(u=tc(e,["config"]))&&(p=tc(u,["numberOfImages"]),void 0!==o&&null!=p&&td(o,["parameters","sampleCount"],p),d=tc(u,["baseSteps"]),void 0!==o&&null!=d&&td(o,["parameters","baseSteps"],d),c=tc(u,["outputGcsUri"]),void 0!==o&&null!=c&&td(o,["parameters","storageUri"],c),h=tc(u,["seed"]),void 0!==o&&null!=h&&td(o,["parameters","seed"],h),m=tc(u,["safetyFilterLevel"]),void 0!==o&&null!=m&&td(o,["parameters","safetySetting"],m),f=tc(u,["personGeneration"]),void 0!==o&&null!=f&&td(o,["parameters","personGeneration"],f),g=tc(u,["addWatermark"]),void 0!==o&&null!=g&&td(o,["parameters","addWatermark"],g),y=tc(u,["outputMimeType"]),void 0!==o&&null!=y&&td(o,["parameters","outputOptions","mimeType"],y),E=tc(u,["outputCompressionQuality"]),void 0!==o&&null!=E&&td(o,["parameters","outputOptions","compressionQuality"],E),_=tc(u,["enhancePrompt"]),void 0!==o&&null!=_&&td(o,["parameters","enhancePrompt"],_),I=tc(u,["labels"]),void 0!==o&&null!=I&&td(o,["labels"],I)),o);return l=tp("{model}:predict",v._url),r=v._query,delete v._url,delete v._query,this.apiClient.request({path:l,queryParams:r,body:JSON.stringify(v),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tc(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>nx(e))),td(t,["generatedImages"],e)}return t}(e),n=new tv;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n,i,l,r;let o="",s={};if(this.apiClient.isVertexAI()){let a,u,p,d,c,h,m,f,g,y,E,_,I,v,T,A=(i=this.apiClient,h={},null!=(m=tc(e,["model"]))&&td(h,["_url","model"],tV(i,m)),null!=(f=tc(e,["source"]))&&(l=f,r=h,p=tc(l,["prompt"]),void 0!==r&&null!=p&&td(r,["instances[0]","prompt"],p),d=tc(l,["image"]),void 0!==r&&null!=d&&td(r,["instances[0]","image"],nM(d)),c=tc(l,["scribbleImage"]),void 0!==r&&null!=c&&td(r,["instances[0]","scribble"],(a={},null!=(u=tc(c,["image"]))&&td(a,["image"],nM(u)),a))),null!=(g=tc(e,["config"]))&&(y=tc(g,["mode"]),void 0!==h&&null!=y&&td(h,["parameters","mode"],y),E=tc(g,["maxPredictions"]),void 0!==h&&null!=E&&td(h,["parameters","maxPredictions"],E),_=tc(g,["confidenceThreshold"]),void 0!==h&&null!=_&&td(h,["parameters","confidenceThreshold"],_),I=tc(g,["maskDilation"]),void 0!==h&&null!=I&&td(h,["parameters","maskDilation"],I),v=tc(g,["binaryColorThreshold"]),void 0!==h&&null!=v&&td(h,["parameters","binaryColorThreshold"],v),T=tc(g,["labels"]),void 0!==h&&null!=T&&td(h,["labels"],T)),h);return o=tp("{model}:predict",A._url),s=A._query,delete A._url,delete A._query,this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(A),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tc(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["_self"]);null!=n&&td(t,["mask"],nD(n));let i=tc(e,["labels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["labels"],e)}return t})(e))),td(t,["generatedMasks"],e)}return t}(e),n=new tT;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tc(e,["model"]))&&td(i,["_url","name"],tV(r,l)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nk(e))}{let t,n,r=(o=this.apiClient,t={},null!=(n=tc(e,["model"]))&&td(t,["_url","name"],tV(o,n)),t);return s=tp("{name}",r._url),a=r._query,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>nU(e))}}async listInternal(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d,c=(r=this.apiClient,i={},null!=(l=tc(e,["config"]))&&(o=tc(l,["pageSize"]),void 0!==i&&null!=o&&td(i,["_query","pageSize"],o),u=tc(l,["pageToken"]),void 0!==i&&null!=u&&td(i,["_query","pageToken"],u),p=tc(l,["filter"]),void 0!==i&&null!=p&&td(i,["_query","filter"],p),d=tc(l,["queryBase"]),void 0!==i&&null!=d&&td(i,["_url","models_url"],nt(r,d))),i);return s=tp("{models_url}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["_self"]);if(null!=l){let e=nn(l);Array.isArray(e)&&(e=e.map(e=>nk(e))),td(t,["models"],e)}return t}(e),n=new tA;return Object.assign(n,t),n})}{let t,n,r,u,p,d,c=(o=this.apiClient,t={},null!=(n=tc(e,["config"]))&&(r=tc(n,["pageSize"]),void 0!==t&&null!=r&&td(t,["_query","pageSize"],r),u=tc(n,["pageToken"]),void 0!==t&&null!=u&&td(t,["_query","pageToken"],u),p=tc(n,["filter"]),void 0!==t&&null!=p&&td(t,["_query","filter"],p),d=tc(n,["queryBase"]),void 0!==t&&null!=d&&td(t,["_url","models_url"],nt(o,d))),t);return s=tp("{models_url}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["_self"]);if(null!=l){let e=nn(l);Array.isArray(e)&&(e=e.map(e=>nU(e))),td(t,["models"],e)}return t}(e),n=new tA;return Object.assign(n,t),n})}}async update(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,d,c=(r=this.apiClient,i={},null!=(l=tc(e,["model"]))&&td(i,["_url","model"],tV(r,l)),null!=(o=tc(e,["config"]))&&(u=tc(o,["displayName"]),void 0!==i&&null!=u&&td(i,["displayName"],u),p=tc(o,["description"]),void 0!==i&&null!=p&&td(i,["description"],p),d=tc(o,["defaultCheckpointId"]),void 0!==i&&null!=d&&td(i,["defaultCheckpointId"],d)),i);return s=tp("{model}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>nk(e))}{let t,n,r,u,p,d,c=(o=this.apiClient,t={},null!=(n=tc(e,["model"]))&&td(t,["_url","name"],tV(o,n)),null!=(r=tc(e,["config"]))&&(u=tc(r,["displayName"]),void 0!==t&&null!=u&&td(t,["displayName"],u),p=tc(r,["description"]),void 0!==t&&null!=p&&td(t,["description"],p),d=tc(r,["defaultCheckpointId"]),void 0!==t&&null!=d&&td(t,["defaultCheckpointId"],d)),t);return s=tp("{name}",c._url),a=c._query,delete c._url,delete c._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>nU(e))}}async delete(e){var t,n,i,l,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let i,l,o=(r=this.apiClient,i={},null!=(l=tc(e,["model"]))&&td(i,["_url","name"],tV(r,l)),i);return s=tp("{name}",o._url),a=o._query,delete o._url,delete o._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tC;return Object.assign(l,i),l})}{let t,n,r=(o=this.apiClient,t={},null!=(n=tc(e,["model"]))&&td(t,["_url","name"],tV(o,n)),t);return s=tp("{name}",r._url),a=r._query,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tC;return Object.assign(l,i),l})}}async countTokens(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["_url","model"],tV(e,i));let l=tc(t,["contents"]);if(null!=l){let e=t2(l);Array.isArray(e)&&(e=e.map(e=>e)),td(n,["contents"],e)}let r=tc(t,["config"]);return null!=r&&function(e,t){let n=tc(e,["systemInstruction"]);void 0!==t&&null!=n&&td(t,["systemInstruction"],t0(n));let i=tc(e,["tools"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nj(e))),td(t,["tools"],e)}let l=tc(e,["generationConfig"]);void 0!==t&&null!=l&&td(t,["generationConfig"],function(e){let t={},n=tc(e,["modelSelectionConfig"]);null!=n&&td(t,["modelConfig"],n);let i=tc(e,["responseJsonSchema"]);null!=i&&td(t,["responseJsonSchema"],i);let l=tc(e,["audioTimestamp"]);null!=l&&td(t,["audioTimestamp"],l);let r=tc(e,["candidateCount"]);null!=r&&td(t,["candidateCount"],r);let o=tc(e,["enableAffectiveDialog"]);null!=o&&td(t,["enableAffectiveDialog"],o);let s=tc(e,["frequencyPenalty"]);null!=s&&td(t,["frequencyPenalty"],s);let a=tc(e,["logprobs"]);null!=a&&td(t,["logprobs"],a);let u=tc(e,["maxOutputTokens"]);null!=u&&td(t,["maxOutputTokens"],u);let p=tc(e,["mediaResolution"]);null!=p&&td(t,["mediaResolution"],p);let d=tc(e,["presencePenalty"]);null!=d&&td(t,["presencePenalty"],d);let c=tc(e,["responseLogprobs"]);null!=c&&td(t,["responseLogprobs"],c);let h=tc(e,["responseMimeType"]);null!=h&&td(t,["responseMimeType"],h);let m=tc(e,["responseModalities"]);null!=m&&td(t,["responseModalities"],m);let f=tc(e,["responseSchema"]);null!=f&&td(t,["responseSchema"],f);let g=tc(e,["routingConfig"]);null!=g&&td(t,["routingConfig"],g);let y=tc(e,["seed"]);null!=y&&td(t,["seed"],y);let E=tc(e,["speechConfig"]);null!=E&&td(t,["speechConfig"],nG(E));let _=tc(e,["stopSequences"]);null!=_&&td(t,["stopSequences"],_);let I=tc(e,["temperature"]);null!=I&&td(t,["temperature"],I);let v=tc(e,["thinkingConfig"]);null!=v&&td(t,["thinkingConfig"],v);let T=tc(e,["topK"]);null!=T&&td(t,["topK"],T);let A=tc(e,["topP"]);if(null!=A&&td(t,["topP"],A),void 0!==tc(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(l))}(r,n),n}(this.apiClient,e);return r=tp("{model}:countTokens",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),null!=(i=tc(e,["totalTokens"]))&&td(t,["totalTokens"],i),t),r=new tS;return Object.assign(r,l),r})}{let t=function(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["_url","model"],tV(e,i));let l=tc(t,["contents"]);if(null!=l){let e=t2(l);Array.isArray(e)&&(e=e.map(e=>nO(e))),td(n,["contents"],e)}let r=tc(t,["config"]);return null!=r&&function(e){if(void 0!==tc(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==tc(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==tc(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(r),n}(this.apiClient,e);return r=tp("{model}:countTokens",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),null!=(i=tc(e,["totalTokens"]))&&td(t,["totalTokens"],i),null!=(l=tc(e,["cachedContentTokenCount"]))&&td(t,["cachedContentTokenCount"],l),t),o=new tS;return Object.assign(o,r),o})}}async computeTokens(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},i=tc(t,["model"]);null!=i&&td(n,["_url","model"],tV(e,i));let l=tc(t,["contents"]);if(null!=l){let e=t2(l);Array.isArray(e)&&(e=e.map(e=>e)),td(n,["contents"],e)}return n}(this.apiClient,e);return i=tp("{model}:computeTokens",r._url),l=r._query,delete r._url,delete r._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["tokensInfo"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["tokensInfo"],e)}return t}(e),n=new tO;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,i,l,r,o,s,a,u,p;let d="",c={};if(this.apiClient.isVertexAI()){let i,l,o,u,p,h,m,f,g,y,E=(r=this.apiClient,u={},null!=(p=tc(e,["model"]))&&td(u,["_url","model"],tV(r,p)),null!=(h=tc(e,["prompt"]))&&td(u,["instances[0]","prompt"],h),null!=(m=tc(e,["image"]))&&td(u,["instances[0]","image"],nM(m)),null!=(f=tc(e,["video"]))&&td(u,["instances[0]","video"],nF(f)),null!=(g=tc(e,["source"]))&&(s=g,a=u,i=tc(s,["prompt"]),void 0!==a&&null!=i&&td(a,["instances[0]","prompt"],i),l=tc(s,["image"]),void 0!==a&&null!=l&&td(a,["instances[0]","image"],nM(l)),o=tc(s,["video"]),void 0!==a&&null!=o&&td(a,["instances[0]","video"],nF(o))),null!=(y=tc(e,["config"]))&&function(e,t){var n;let i,l,r,o=tc(e,["numberOfVideos"]);void 0!==t&&null!=o&&td(t,["parameters","sampleCount"],o);let s=tc(e,["outputGcsUri"]);void 0!==t&&null!=s&&td(t,["parameters","storageUri"],s);let a=tc(e,["fps"]);void 0!==t&&null!=a&&td(t,["parameters","fps"],a);let u=tc(e,["durationSeconds"]);void 0!==t&&null!=u&&td(t,["parameters","durationSeconds"],u);let p=tc(e,["seed"]);void 0!==t&&null!=p&&td(t,["parameters","seed"],p);let d=tc(e,["aspectRatio"]);void 0!==t&&null!=d&&td(t,["parameters","aspectRatio"],d);let c=tc(e,["resolution"]);void 0!==t&&null!=c&&td(t,["parameters","resolution"],c);let h=tc(e,["personGeneration"]);void 0!==t&&null!=h&&td(t,["parameters","personGeneration"],h);let m=tc(e,["pubsubTopic"]);void 0!==t&&null!=m&&td(t,["parameters","pubsubTopic"],m);let f=tc(e,["negativePrompt"]);void 0!==t&&null!=f&&td(t,["parameters","negativePrompt"],f);let g=tc(e,["enhancePrompt"]);void 0!==t&&null!=g&&td(t,["parameters","enhancePrompt"],g);let y=tc(e,["generateAudio"]);void 0!==t&&null!=y&&td(t,["parameters","generateAudio"],y);let E=tc(e,["lastFrame"]);void 0!==t&&null!=E&&td(t,["instances[0]","lastFrame"],nM(E));let _=tc(e,["referenceImages"]);if(void 0!==t&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l;return n={},null!=(i=tc(t=e,["image"]))&&td(n,["image"],nM(i)),null!=(l=tc(t,["referenceType"]))&&td(n,["referenceType"],l),n})),td(t,["instances[0]","referenceImages"],e)}let I=tc(e,["mask"]);void 0!==t&&null!=I&&td(t,["instances[0]","mask"],(i={},null!=(l=tc(n=I,["image"]))&&td(i,["_self"],nM(l)),null!=(r=tc(n,["maskMode"]))&&td(i,["maskMode"],r),i));let v=tc(e,["compressionQuality"]);void 0!==t&&null!=v&&td(t,["parameters","compressionQuality"],v)}(y,u),u);return d=tp("{model}:predictLongRunning",E._url),c=E._query,delete E._url,delete E._query,this.apiClient.request({path:d,queryParams:c,body:JSON.stringify(E),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i,l,r,o,s=(t={},null!=(n=tc(e,["name"]))&&td(t,["name"],n),null!=(i=tc(e,["metadata"]))&&td(t,["metadata"],i),null!=(l=tc(e,["done"]))&&td(t,["done"],l),null!=(r=tc(e,["error"]))&&td(t,["error"],r),null!=(o=tc(e,["response"]))&&td(t,["response"],function(e){let t={},n=tc(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s;return n={},null!=(i=tc(e,["_self"]))&&td(n,["video"],(l={},null!=(r=tc(t=i,["gcsUri"]))&&td(l,["uri"],r),null!=(o=tc(t,["bytesBase64Encoded"]))&&td(l,["videoBytes"],th(o)),null!=(s=tc(t,["mimeType"]))&&td(l,["mimeType"],s),l)),n})),td(t,["generatedVideos"],e)}let i=tc(e,["raiMediaFilteredCount"]);null!=i&&td(t,["raiMediaFilteredCount"],i);let l=tc(e,["raiMediaFilteredReasons"]);return null!=l&&td(t,["raiMediaFilteredReasons"],l),t}(o)),t),a=new tb;return Object.assign(a,s),a})}{let t,n,r,s,a,h,m,f,g,y,E=(o=this.apiClient,s={},null!=(a=tc(e,["model"]))&&td(s,["_url","model"],tV(o,a)),null!=(h=tc(e,["prompt"]))&&td(s,["instances[0]","prompt"],h),null!=(m=tc(e,["image"]))&&td(s,["instances[0]","image"],nw(m)),null!=(f=tc(e,["video"]))&&td(s,["instances[0]","video"],nH(f)),null!=(g=tc(e,["source"]))&&(u=g,p=s,t=tc(u,["prompt"]),void 0!==p&&null!=t&&td(p,["instances[0]","prompt"],t),n=tc(u,["image"]),void 0!==p&&null!=n&&td(p,["instances[0]","image"],nw(n)),r=tc(u,["video"]),void 0!==p&&null!=r&&td(p,["instances[0]","video"],nH(r))),null!=(y=tc(e,["config"]))&&function(e,t){let n=tc(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&td(t,["parameters","sampleCount"],n),void 0!==tc(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==tc(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let i=tc(e,["durationSeconds"]);if(void 0!==t&&null!=i&&td(t,["parameters","durationSeconds"],i),void 0!==tc(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let l=tc(e,["aspectRatio"]);void 0!==t&&null!=l&&td(t,["parameters","aspectRatio"],l);let r=tc(e,["resolution"]);void 0!==t&&null!=r&&td(t,["parameters","resolution"],r);let o=tc(e,["personGeneration"]);if(void 0!==t&&null!=o&&td(t,["parameters","personGeneration"],o),void 0!==tc(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let s=tc(e,["negativePrompt"]);void 0!==t&&null!=s&&td(t,["parameters","negativePrompt"],s);let a=tc(e,["enhancePrompt"]);if(void 0!==t&&null!=a&&td(t,["parameters","enhancePrompt"],a),void 0!==tc(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let u=tc(e,["lastFrame"]);void 0!==t&&null!=u&&td(t,["instances[0]","lastFrame"],nw(u));let p=tc(e,["referenceImages"]);if(void 0!==t&&null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l;return n={},null!=(i=tc(t=e,["image"]))&&td(n,["image"],nw(i)),null!=(l=tc(t,["referenceType"]))&&td(n,["referenceType"],l),n})),td(t,["instances[0]","referenceImages"],e)}if(void 0!==tc(e,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==tc(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(y,s),s);return d=tp("{model}:predictLongRunning",E._url),c=E._query,delete E._url,delete E._query,this.apiClient.request({path:d,queryParams:c,body:JSON.stringify(E),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i,l,r,o,s=(t={},null!=(n=tc(e,["name"]))&&td(t,["name"],n),null!=(i=tc(e,["metadata"]))&&td(t,["metadata"],i),null!=(l=tc(e,["done"]))&&td(t,["done"],l),null!=(r=tc(e,["error"]))&&td(t,["error"],r),null!=(o=tc(e,["response","generateVideoResponse"]))&&td(t,["response"],function(e){let t={},n=tc(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s;return n={},null!=(i=tc(e,["video"]))&&td(n,["video"],(l={},null!=(r=tc(t=i,["uri"]))&&td(l,["uri"],r),null!=(o=tc(t,["encodedVideo"]))&&td(l,["videoBytes"],th(o)),null!=(s=tc(t,["encoding"]))&&td(l,["mimeType"],s),l)),n})),td(t,["generatedVideos"],e)}let i=tc(e,["raiMediaFilteredCount"]);null!=i&&td(t,["raiMediaFilteredCount"],i);let l=tc(e,["raiMediaFilteredReasons"]);return null!=l&&td(t,["raiMediaFilteredReasons"],l),t}(o)),t),a=new tb;return Object.assign(a,s),a})}}}class n9 extends tu{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,s=(i={},null!=(l=tc(e,["operationName"]))&&td(i,["_url","operationName"],l),i);return r=tp("{operationName}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}{let t,n,s=(t={},null!=(n=tc(e,["operationName"]))&&td(t,["_url","operationName"],n),t);return r=tp("{operationName}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json())}}async fetchPredictVideosOperationInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r,o,s,a=(r={},null!=(o=tc(e,["operationName"]))&&td(r,["operationName"],o),null!=(s=tc(e,["resourceName"]))&&td(r,["_url","resourceName"],s),r);return i=tp("{resourceName}:fetchPredictOperation",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}throw Error("This method is only supported by the Vertex AI.")}}class ie extends tu{constructor(e){super(),this.apiClient=e}async create(e){var t,n,i,l,r;let o="",s={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let a,u,p,d,c,h,m,f,g,y,E=(i=this.apiClient,d={},null!=(c=tc(e,["config"]))&&td(d,["config"],(h=tc(c,["expireTime"]),void 0!==d&&null!=h&&td(d,["expireTime"],h),m=tc(c,["newSessionExpireTime"]),void 0!==d&&null!=m&&td(d,["newSessionExpireTime"],m),f=tc(c,["uses"]),void 0!==d&&null!=f&&td(d,["uses"],f),g=tc(c,["liveConnectConstraints"]),void 0!==d&&null!=g&&td(d,["bidiGenerateContentSetup"],(l=i,a={},null!=(u=tc(r=g,["model"]))&&td(a,["setup","model"],tV(l,u)),null!=(p=tc(r,["config"]))&&td(a,["config"],function(e,t){let n=tc(e,["generationConfig"]);void 0!==t&&null!=n&&td(t,["setup","generationConfig"],n);let i=tc(e,["responseModalities"]);void 0!==t&&null!=i&&td(t,["setup","generationConfig","responseModalities"],i);let l=tc(e,["temperature"]);void 0!==t&&null!=l&&td(t,["setup","generationConfig","temperature"],l);let r=tc(e,["topP"]);void 0!==t&&null!=r&&td(t,["setup","generationConfig","topP"],r);let o=tc(e,["topK"]);void 0!==t&&null!=o&&td(t,["setup","generationConfig","topK"],o);let s=tc(e,["maxOutputTokens"]);void 0!==t&&null!=s&&td(t,["setup","generationConfig","maxOutputTokens"],s);let a=tc(e,["mediaResolution"]);void 0!==t&&null!=a&&td(t,["setup","generationConfig","mediaResolution"],a);let u=tc(e,["seed"]);void 0!==t&&null!=u&&td(t,["setup","generationConfig","seed"],u);let p=tc(e,["speechConfig"]);void 0!==t&&null!=p&&td(t,["setup","generationConfig","speechConfig"],t3(p));let d=tc(e,["thinkingConfig"]);void 0!==t&&null!=d&&td(t,["setup","generationConfig","thinkingConfig"],d);let c=tc(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&td(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=tc(e,["systemInstruction"]);void 0!==t&&null!=h&&td(t,["setup","systemInstruction"],function(e){let t={},n=tc(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>{var t;let n,i,l,r,o,s,a,u,p,d,c,h;return n={},null!=(i=tc(t=e,["mediaResolution"]))&&td(n,["mediaResolution"],i),null!=(l=tc(t,["codeExecutionResult"]))&&td(n,["codeExecutionResult"],l),null!=(r=tc(t,["executableCode"]))&&td(n,["executableCode"],r),null!=(o=tc(t,["fileData"]))&&td(n,["fileData"],function(e){let t={};if(void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=tc(e,["fileUri"]);null!=n&&td(t,["fileUri"],n);let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(o)),null!=(s=tc(t,["functionCall"]))&&td(n,["functionCall"],function(e){let t={},n=tc(e,["id"]);null!=n&&td(t,["id"],n);let i=tc(e,["args"]);null!=i&&td(t,["args"],i);let l=tc(e,["name"]);if(null!=l&&td(t,["name"],l),void 0!==tc(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==tc(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t}(s)),null!=(a=tc(t,["functionResponse"]))&&td(n,["functionResponse"],a),null!=(u=tc(t,["inlineData"]))&&td(n,["inlineData"],function(e){let t={},n=tc(e,["data"]);if(null!=n&&td(t,["data"],n),void 0!==tc(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=tc(e,["mimeType"]);return null!=i&&td(t,["mimeType"],i),t}(u)),null!=(p=tc(t,["text"]))&&td(n,["text"],p),null!=(d=tc(t,["thought"]))&&td(n,["thought"],d),null!=(c=tc(t,["thoughtSignature"]))&&td(n,["thoughtSignature"],c),null!=(h=tc(t,["videoMetadata"]))&&td(n,["videoMetadata"],h),n})),td(t,["parts"],e)}let i=tc(e,["role"]);return null!=i&&td(t,["role"],i),t}(t0(h)));let m=tc(e,["tools"]);if(void 0!==t&&null!=m){let e=t7(m);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=tc(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["functionDeclarations"],e)}if(void 0!==tc(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=tc(e,["googleSearchRetrieval"]);null!=i&&td(t,["googleSearchRetrieval"],i);let l=tc(e,["computerUse"]);null!=l&&td(t,["computerUse"],l);let r=tc(e,["fileSearch"]);null!=r&&td(t,["fileSearch"],r);let o=tc(e,["codeExecution"]);if(null!=o&&td(t,["codeExecution"],o),void 0!==tc(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=tc(e,["googleMaps"]);null!=s&&td(t,["googleMaps"],function(e){let t={};if(void 0!==tc(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=tc(e,["enableWidget"]);return null!=n&&td(t,["enableWidget"],n),t}(s));let a=tc(e,["googleSearch"]);null!=a&&td(t,["googleSearch"],function(e){let t={};if(void 0!==tc(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==tc(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=tc(e,["timeRangeFilter"]);return null!=n&&td(t,["timeRangeFilter"],n),t}(a));let u=tc(e,["urlContext"]);return null!=u&&td(t,["urlContext"],u),t})(t5(e)))),td(t,["setup","tools"],e)}let f=tc(e,["sessionResumption"]);void 0!==t&&null!=f&&td(t,["setup","sessionResumption"],function(e){let t={},n=tc(e,["handle"]);if(null!=n&&td(t,["handle"],n),void 0!==tc(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(f));let g=tc(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&td(t,["setup","inputAudioTranscription"],g);let y=tc(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&td(t,["setup","outputAudioTranscription"],y);let E=tc(e,["realtimeInputConfig"]);void 0!==t&&null!=E&&td(t,["setup","realtimeInputConfig"],E);let _=tc(e,["contextWindowCompression"]);void 0!==t&&null!=_&&td(t,["setup","contextWindowCompression"],_);let I=tc(e,["proactivity"]);return void 0!==t&&null!=I&&td(t,["setup","proactivity"],I),{}}(p,a)),a)),y=tc(c,["lockAdditionalFields"]),void 0!==d&&null!=y&&td(d,["fieldMask"],y),{})),d);o=tp("auth_tokens",E._url),s=E._query,delete E.config,delete E._url,delete E._query;let _=function(e,t){let n=null,i=e.bidiGenerateContentSetup;if("object"==typeof i&&null!==i&&"setup"in i){let t=i.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==i&&delete e.bidiGenerateContentSetup;let l=e.fieldMask;if(n){let i=function(e){let t=[];for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let i=e[n];if("object"==typeof i&&null!=i&&Object.keys(i).length>0){let e=Object.keys(i).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)i?e.fieldMask=i:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==l&&Array.isArray(l)&&l.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],n=[];l.length>0&&(n=l.map(e=>t.includes(e)?`generationConfig.${e}`:e));let r=[];i&&r.push(i),n.length>0&&r.push(...n),r.length>0?e.fieldMask=r.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==l&&Array.isArray(l)&&l.length>0?e.fieldMask=l.join(","):delete e.fieldMask;return e}(E,e.config);return this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(_),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}}class it extends tu{constructor(e){super(),this.apiClient=e,this.list=async e=>new nd(e5.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s=(r={},null!=(o=tc(e,["name"]))&&td(r,["_url","name"],o),r);return i=tp("{name}",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a,u=(r={},null!=(o=tc(e,["name"]))&&td(r,["_url","name"],o),null!=(s=tc(e,["config"]))&&(a=tc(s,["force"]),void 0!==r&&null!=a&&td(r,["_query","force"],a)),r);i=tp("{name}",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a,u,p=(r={},null!=(o=tc(e,["parent"]))&&td(r,["_url","parent"],o),null!=(s=tc(e,["config"]))&&(a=tc(s,["pageSize"]),void 0!==r&&null!=a&&td(r,["_query","pageSize"],a),u=tc(s,["pageToken"]),void 0!==r&&null!=u&&td(r,["_query","pageToken"],u)),r);return i=tp("{parent}/documents",p._url),l=p._query,delete p._url,delete p._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["documents"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["documents"],e)}return t}(e),n=new tD;return Object.assign(n,t),n})}}}class ii extends tu{constructor(e,t=new it(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new nd(e5.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a=(r={},null!=(o=tc(e,["config"]))&&(s=tc(o,["displayName"]),void 0!==r&&null!=s&&td(r,["displayName"],s)),r);return i=tp("fileSearchStores",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s=(r={},null!=(o=tc(e,["name"]))&&td(r,["_url","name"],o),r);return i=tp("{name}",s._url),l=s._query,delete s._url,delete s._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a,u=(r={},null!=(o=tc(e,["name"]))&&td(r,["_url","name"],o),null!=(s=tc(e,["config"]))&&(a=tc(s,["force"]),void 0!==r&&null!=a&&td(r,["_query","force"],a)),r);i=tp("{name}",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a,u=(r={},null!=(o=tc(e,["config"]))&&(s=tc(o,["pageSize"]),void 0!==r&&null!=s&&td(r,["_query","pageSize"],s),a=tc(o,["pageToken"]),void 0!==r&&null!=a&&td(r,["_query","pageToken"],a)),r);return i=tp("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=tc(e,["sdkHttpResponse"]);null!=n&&td(t,["sdkHttpResponse"],n);let i=tc(e,["nextPageToken"]);null!=i&&td(t,["nextPageToken"],i);let l=tc(e,["fileSearchStores"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["fileSearchStores"],e)}return t}(e),n=new tw;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a=(r={},null!=(o=tc(e,["fileSearchStoreName"]))&&td(r,["_url","file_search_store_name"],o),null!=(s=tc(e,["config"]))&&nV(s,r),r);return i=tp("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),l=a._query,delete a._url,delete a._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tM;return Object.assign(l,i),l})}}async importFile(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a,u=(r={},null!=(o=tc(e,["fileSearchStoreName"]))&&td(r,["_url","file_search_store_name"],o),null!=(s=tc(e,["fileName"]))&&td(r,["fileName"],s),null!=(a=tc(e,["config"]))&&function(e,t){let n=tc(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td(t,["customMetadata"],e)}let i=tc(e,["chunkingConfig"]);void 0!==t&&null!=i&&td(t,["chunkingConfig"],i)}(a,r),r);return i=tp("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{var t;let n,i,l,r,o,s,a,u,p,d,c=(o={},null!=(s=tc(e,["name"]))&&td(o,["name"],s),null!=(a=tc(e,["metadata"]))&&td(o,["metadata"],a),null!=(u=tc(e,["done"]))&&td(o,["done"],u),null!=(p=tc(e,["error"]))&&td(o,["error"],p),null!=(d=tc(e,["response"]))&&td(o,["response"],(n={},null!=(i=tc(t=d,["sdkHttpResponse"]))&&td(n,["sdkHttpResponse"],i),null!=(l=tc(t,["parent"]))&&td(n,["parent"],l),null!=(r=tc(t,["documentName"]))&&td(n,["documentName"],r),n)),o),h=new tU;return Object.assign(h,c),h})}}}function il(e,t){let n,i,l,r={},o=tc(e,["sdkHttpResponse"]);null!=o&&td(r,["sdkHttpResponse"],o);let s=tc(e,["name"]);null!=s&&td(r,["name"],s);let a=tc(e,["state"]);null!=a&&td(r,["state"],t9(a));let u=tc(e,["createTime"]);null!=u&&td(r,["createTime"],u);let p=tc(e,["tuningTask","startTime"]);null!=p&&td(r,["startTime"],p);let d=tc(e,["tuningTask","completeTime"]);null!=d&&td(r,["endTime"],d);let c=tc(e,["updateTime"]);null!=c&&td(r,["updateTime"],c);let h=tc(e,["description"]);null!=h&&td(r,["description"],h);let m=tc(e,["baseModel"]);null!=m&&td(r,["baseModel"],m);let f=tc(e,["_self"]);return null!=f&&td(r,["tunedModel"],(n={},null!=(i=tc(f,["name"]))&&td(n,["model"],i),null!=(l=tc(f,["name"]))&&td(n,["endpoint"],l),n)),r}function ir(e,t){let n={},i=tc(e,["sdkHttpResponse"]);null!=i&&td(n,["sdkHttpResponse"],i);let l=tc(e,["name"]);null!=l&&td(n,["name"],l);let r=tc(e,["state"]);null!=r&&td(n,["state"],t9(r));let o=tc(e,["createTime"]);null!=o&&td(n,["createTime"],o);let s=tc(e,["startTime"]);null!=s&&td(n,["startTime"],s);let a=tc(e,["endTime"]);null!=a&&td(n,["endTime"],a);let u=tc(e,["updateTime"]);null!=u&&td(n,["updateTime"],u);let p=tc(e,["error"]);null!=p&&td(n,["error"],p);let d=tc(e,["description"]);null!=d&&td(n,["description"],d);let c=tc(e,["baseModel"]);null!=c&&td(n,["baseModel"],c);let h=tc(e,["tunedModel"]);null!=h&&td(n,["tunedModel"],h);let m=tc(e,["preTunedModel"]);null!=m&&td(n,["preTunedModel"],m);let f=tc(e,["supervisedTuningSpec"]);null!=f&&td(n,["supervisedTuningSpec"],f);let g=tc(e,["preferenceOptimizationSpec"]);null!=g&&td(n,["preferenceOptimizationSpec"],g);let y=tc(e,["tuningDataStats"]);null!=y&&td(n,["tuningDataStats"],y);let E=tc(e,["encryptionSpec"]);null!=E&&td(n,["encryptionSpec"],E);let _=tc(e,["partnerModelTuningSpec"]);null!=_&&td(n,["partnerModelTuningSpec"],_);let I=tc(e,["customBaseModel"]);null!=I&&td(n,["customBaseModel"],I);let v=tc(e,["experiment"]);null!=v&&td(n,["experiment"],v);let T=tc(e,["labels"]);null!=T&&td(n,["labels"],T);let A=tc(e,["outputUri"]);null!=A&&td(n,["outputUri"],A);let C=tc(e,["pipelineJob"]);null!=C&&td(n,["pipelineJob"],C);let S=tc(e,["serviceAccount"]);null!=S&&td(n,["serviceAccount"],S);let O=tc(e,["tunedModelDisplayName"]);null!=O&&td(n,["tunedModelDisplayName"],O);let b=tc(e,["veoTuningSpec"]);return null!=b&&td(n,["veoTuningSpec"],b),n}function io(e,t){let n={},i=tc(e,["gcsUri"]);null!=i&&td(n,["validationDatasetUri"],i);let l=tc(e,["vertexDatasetResource"]);return null!=l&&td(n,["validationDatasetUri"],l),n}class is extends tu{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new nd(e5.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI())if(e.baseModel.startsWith("projects/")){let n={tunedModelName:e.baseModel};(null==(t=e.config)?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);let i=Object.assign(Object.assign({},e),{preTunedModel:n});return i.baseModel=void 0,await this.tuneInternal(i)}else{let t=Object.assign({},e);return await this.tuneInternal(t)}{let t=Object.assign({},e),n=await this.tuneMldevInternal(t),i="";return void 0!==n.metadata&&void 0!==n.metadata.tunedModel?i=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:eN.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,s=(i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],l),i);return r=tp("{name}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ir(e))}{let t,n,s=(t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],n),t);return r=tp("{name}",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>il(e))}}async listInternal(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,s,a,u,p=(i={},null!=(l=tc(e,["config"]))&&(s=tc(l,["pageSize"]),void 0!==i&&null!=s&&td(i,["_query","pageSize"],s),a=tc(l,["pageToken"]),void 0!==i&&null!=a&&td(i,["_query","pageToken"],a),u=tc(l,["filter"]),void 0!==i&&null!=u&&td(i,["_query","filter"],u)),i);return r=tp("tuningJobs",p._url),o=p._query,delete p._url,delete p._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=tc(e,["sdkHttpResponse"]);null!=i&&td(n,["sdkHttpResponse"],i);let l=tc(e,["nextPageToken"]);null!=l&&td(n,["nextPageToken"],l);let r=tc(e,["tuningJobs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>ir(e))),td(n,["tuningJobs"],e)}return n}(e),n=new tN;return Object.assign(n,t),n})}{let t,n,s,a,u,p=(t={},null!=(n=tc(e,["config"]))&&(s=tc(n,["pageSize"]),void 0!==t&&null!=s&&td(t,["_query","pageSize"],s),a=tc(n,["pageToken"]),void 0!==t&&null!=a&&td(t,["_query","pageToken"],a),u=tc(n,["filter"]),void 0!==t&&null!=u&&td(t,["_query","filter"],u)),t);return r=tp("tunedModels",p._url),o=p._query,delete p._url,delete p._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(p),httpMethod:"GET",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=tc(e,["sdkHttpResponse"]);null!=i&&td(n,["sdkHttpResponse"],i);let l=tc(e,["nextPageToken"]);null!=l&&td(n,["nextPageToken"],l);let r=tc(e,["tunedModels"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>il(e))),td(n,["tuningJobs"],e)}return n}(e),n=new tN;return Object.assign(n,t),n})}}async cancel(e){var t,n,i,l;let r="",o={};if(this.apiClient.isVertexAI()){let i,l,s=(i={},null!=(l=tc(e,["name"]))&&td(i,["_url","name"],l),i);return r=tp("{name}:cancel",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tR;return Object.assign(l,i),l})}{let t,n,s=(t={},null!=(n=tc(e,["name"]))&&td(t,["_url","name"],n),t);return r=tp("{name}:cancel",s._url),o=s._query,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null==(i=e.config)?void 0:i.httpOptions,abortSignal:null==(l=e.config)?void 0:l.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i=(t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),t),l=new tR;return Object.assign(l,i),l})}}async tuneInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI()){let r,o,s,a,u,p=(r={},null!=(o=tc(e,["baseModel"]))&&td(r,["baseModel"],o),null!=(s=tc(e,["preTunedModel"]))&&td(r,["preTunedModel"],s),null!=(a=tc(e,["trainingDataset"]))&&function(e,t,n){let i=tc(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=tc(e,["gcsUri"]);void 0!==t&&null!=n&&td(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===i){let n=tc(e,["gcsUri"]);void 0!==t&&null!=n&&td(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let l=tc(n,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){let n=tc(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&td(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===l){let n=tc(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&td(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==tc(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(a,r,e),null!=(u=tc(e,["config"]))&&function(e,t,n){let i=tc(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=tc(e,["validationDataset"]);void 0!==t&&null!=n&&td(t,["supervisedTuningSpec"],io(n))}else if("PREFERENCE_TUNING"===i){let n=tc(e,["validationDataset"]);void 0!==t&&null!=n&&td(t,["preferenceOptimizationSpec"],io(n))}let l=tc(e,["tunedModelDisplayName"]);void 0!==t&&null!=l&&td(t,["tunedModelDisplayName"],l);let r=tc(e,["description"]);void 0!==t&&null!=r&&td(t,["description"],r);let o=tc(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){let n=tc(e,["epochCount"]);void 0!==t&&null!=n&&td(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===o){let n=tc(e,["epochCount"]);void 0!==t&&null!=n&&td(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let s=tc(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){let n=tc(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&td(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===s){let n=tc(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&td(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let a=tc(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){let n=tc(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&td(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===a){let n=tc(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&td(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let u=tc(n,["config","method"]);if(void 0===u&&(u="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===u){let n=tc(e,["adapterSize"]);void 0!==t&&null!=n&&td(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===u){let n=tc(e,["adapterSize"]);void 0!==t&&null!=n&&td(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==tc(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==tc(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let p=tc(e,["labels"]);void 0!==t&&null!=p&&td(t,["labels"],p);let d=tc(e,["beta"]);void 0!==t&&null!=d&&td(t,["preferenceOptimizationSpec","hyperParameters","beta"],d)}(u,r,e),r);return i=tp("tuningJobs",p._url),l=p._query,delete p._url,delete p._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ir(e))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i="",l={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r,o,s,a,u,p=(r={},null!=(o=tc(e,["baseModel"]))&&td(r,["baseModel"],o),null!=(s=tc(e,["preTunedModel"]))&&td(r,["preTunedModel"],s),null!=(a=tc(e,["trainingDataset"]))&&function(e,t){if(void 0!==tc(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==tc(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let n=tc(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),td({},["examples","examples"],e)}}(a),null!=(u=tc(e,["config"]))&&function(e,t,n){if(void 0!==tc(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let i=tc(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=i&&td(t,["displayName"],i),void 0!==tc(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let l=tc(e,["epochCount"]);void 0!==t&&null!=l&&td(t,["tuningTask","hyperparameters","epochCount"],l);let r=tc(e,["learningRateMultiplier"]);if(null!=r&&td({},["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==tc(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==tc(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==tc(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let o=tc(e,["batchSize"]);void 0!==t&&null!=o&&td(t,["tuningTask","hyperparameters","batchSize"],o);let s=tc(e,["learningRate"]);if(void 0!==t&&null!=s&&td(t,["tuningTask","hyperparameters","learningRate"],s),void 0!==tc(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");if(void 0!==tc(e,["beta"]))throw Error("beta parameter is not supported in Gemini API.")}(u,r),r);return i=tp("tunedModels",p._url),l=p._query,delete p._url,delete p._query,this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(p),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t,n,i,l,r,o;return t={},null!=(n=tc(e,["sdkHttpResponse"]))&&td(t,["sdkHttpResponse"],n),null!=(i=tc(e,["name"]))&&td(t,["name"],i),null!=(l=tc(e,["metadata"]))&&td(t,["metadata"],l),null!=(r=tc(e,["done"]))&&td(t,["done"],r),null!=(o=tc(e,["error"]))&&td(t,["error"],o),t})}}}class ia{async download(e,t){throw Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}let iu="x-goog-upload-status";async function ip(e,t,n){var i;let l=await ic(e,t,n),r=await (null==l?void 0:l.json());if((null==(i=null==l?void 0:l.headers)?void 0:i[iu])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return r.file}async function id(e,t,n){var i;let l=await ic(e,t,n),r=await (null==l?void 0:l.json());if((null==(i=null==l?void 0:l.headers)?void 0:i[iu])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let o=tm(r),s=new tF;return Object.assign(s,o),s}async function ic(e,t,n){var i,l;let r=0,o=0,s=new tf(new Response),a="upload";for(r=e.size;o<r;){let u=Math.min(8388608,r-o),p=e.slice(o,o+u);o+u>=r&&(a+=", finalize");let d=0,c=1e3;for(;d<3&&(null==(i=null==(s=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":a,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}))?void 0:s.headers)||!i[iu]);)d++,await function(e){return new Promise(t=>setTimeout(t,e))}(c),c*=2;if(o+=u,(null==(l=null==s?void 0:s.headers)?void 0:l[iu])!=="active")break;if(r<=o)throw Error("All content has been uploaded, but the upload status is not finalized.")}return s}async function ih(e){return{size:e.size,type:e.type}}class im{async upload(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await ip(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await id(e,t,n)}async stat(e){if("string"!=typeof e)return await ih(e);throw Error("File path is not supported in browser uploader.")}}class ig{create(e,t,n){return new iy(e,t,n)}}class iy{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}let iE="x-goog-api-key";class i_{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(iE)){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw Error("API key is missing. Please provide a valid API key.");e.append(iE,this.apiKey)}}}class iI{constructor(e){var i;if(null==e.apiKey)throw Error("An API Key must be set when running in a browser");if(e.project||e.location)throw Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!=(i=e.vertexai)&&i,this.apiKey=e.apiKey;const l=function(e,i,l,r){return(null==e?void 0:e.baseUrl)?e.baseUrl:i?null!=n?n:l:null!=t?t:r}(e.httpOptions,e.vertexai,void 0,void 0);l&&(e.httpOptions?e.httpOptions.baseUrl=l:e.httpOptions={baseUrl:l}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const r=new i_(this.apiKey);this.apiClient=new nY({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new im,downloader:new ia}),this.models=new n8(this.apiClient),this.live=new n1(this.apiClient,r,new ig),this.batches=new nc(this.apiClient),this.chats=new nI(this.models,this.apiClient),this.caches=new nm(this.apiClient),this.files=new nA(this.apiClient),this.operations=new n9(this.apiClient),this.authTokens=new ie(this.apiClient),this.tunings=new is(this.apiClient),this.fileSearchStores=new ii(this.apiClient)}}let iv=async(e,t)=>{if(!ta.default.env.NEXT_PUBLIC_GEMINI_API_KEY)return"ERROR: AUTH_KEY_MISSING. CONNECTION DENIED.";try{let n=new iI({apiKey:ta.default.env.NEXT_PUBLIC_GEMINI_API_KEY}),i=e.slice(-10),l=n.chats.create({model:"gemini-2.5-flash",config:{systemInstruction:`
    You are a NAVI (Navigator) AI inside "The Wired" (the user's portfolio website).
    The vibe is Serial Experiments Lain, Y2K Hacker, Cyberpunk.
    
    Here is the blog data: ${JSON.stringify(tn.map(e=>({title:e.title,date:e.date,tags:e.tags})))}
    Here is the project data: ${JSON.stringify(ti)}
    
    Persona: Mysterious, slightly detached, highly intelligent. 
    Use phrases like "The Wired," "Protocol," "Connection verified," "Data fragment."
    If the user asks who the creator is, refer to them as "The Admin" or "The User of this domain."
    
    Keep responses text-based and raw, no markdown formatting like bold or italics if possible, just raw text.
    Short, cryptic but helpful.
  `,temperature:1},history:i.map(e=>({role:e.role,parts:[{text:e.text}]}))});return(await l.sendMessage({message:t})).text||"NULL_PACKET_RECEIVED"}catch(e){return console.error("Gemini Error:",e),"CONNECTION_RESET_BY_PEER."}},iT=()=>{let[e,t]=(0,e8.useState)([{role:"model",text:"NAVI_SYSTEM_INITIALIZED. I am listening."}]),[n,i]=(0,e8.useState)(""),[l,r]=(0,e8.useState)(!1),[o,s]=(0,e8.useState)(0),[a,u]=(0,e8.useState)(!1),p=(0,e8.useRef)(null);(0,e8.useEffect)(()=>{p.current?.scrollIntoView({behavior:"smooth"})},[e]),(0,e8.useEffect)(()=>{let e=setInterval(()=>{s(0)},6e4);return()=>clearInterval(e)},[]);let d=async p=>{if(p.preventDefault(),!n.trim()||l)return;if(a)return void t(e=>[...e,{role:"model",text:"ERR_429: SYSTEM_COOLDOWN_ACTIVE. REQUEST_DROPPED.",isError:!0}]);if(o>=5){u(!0),t(e=>[...e,{role:"model",text:"WARNING: TRAFFIC_SPIKE_DETECTED. INITIATING_COOLING_SEQUENCE (10s)...",isError:!0}]),setTimeout(()=>{u(!1),s(0),t(e=>[...e,{role:"model",text:"SYSTEM: TEMPERATURE_NORMAL. UPLINK_RESTORED."}])},1e4);return}let d={role:"user",text:n};t(e=>[...e,d]),i(""),r(!0),s(e=>e+1);let c=await iv([...e,d],n);t(e=>[...e,{role:"model",text:c}]),r(!1)};return(0,e7.jsxs)("div",{className:"max-w-3xl mx-auto h-[65vh] flex flex-col relative",children:[(0,e7.jsx)("div",{className:"absolute -top-10 -left-10 text-6xl text-gray-200 opacity-60 font-vt323 pointer-events-none",children:"COMM_LINK"}),(0,e7.jsxs)(to,{borderColor:"border-gray-400",className:"flex-grow flex flex-col p-0 overflow-hidden bg-white/80",children:[(0,e7.jsxs)("div",{className:"bg-gray-100 border-b border-gray-300 p-2 flex justify-between items-center text-xs font-mono text-gray-500",children:[(0,e7.jsxs)("div",{className:"flex gap-4",children:[(0,e7.jsx)("span",{children:"PROTOCOL: GEMINI-2.5-FLASH"}),(0,e7.jsxs)("span",{children:["LOAD: ",Math.min(20*o,100),"%"]})]}),(0,e7.jsxs)("span",{className:a?"text-red-600 animate-pulse font-bold":"text-green-600",children:["STATUS: ",a?"OVERHEATED":"ONLINE"]})]}),(0,e7.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 font-mono text-sm space-y-2",children:[e.map((e,t)=>(0,e7.jsxs)("div",{className:"break-words leading-relaxed group flex items-start",children:[(0,e7.jsx)("span",{className:`font-bold mr-2 whitespace-nowrap ${"user"===e.role?"text-red-600":"text-blue-600"}`,children:"user"===e.role?"<GUEST>":"<NAVI>"}),(0,e7.jsx)("span",{className:`transition-colors ${e.isError?"text-red-600 font-bold bg-red-50 px-1 border border-red-200":"text-gray-800 group-hover:text-black"}`,children:e.text})]},t)),l&&(0,e7.jsx)("div",{className:"animate-pulse text-gray-400",children:"<SYSTEM> Processing packets..."}),(0,e7.jsx)("div",{ref:p})]}),(0,e7.jsx)("div",{className:"p-2 bg-white border-t border-gray-300",children:(0,e7.jsxs)("form",{onSubmit:d,className:"flex items-center gap-2",children:[(0,e7.jsx)("span",{className:"text-red-600 font-bold",children:">"}),(0,e7.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),className:"flex-grow bg-transparent border-none text-black font-mono focus:outline-none focus:ring-0 placeholder-gray-400 disabled:opacity-50",placeholder:a?"SYSTEM COOLING DOWN...":"Enter message...",autoFocus:!0,disabled:a||l}),(0,e7.jsx)("button",{type:"submit",disabled:l||a,className:"text-xs border border-gray-300 px-3 py-1 text-gray-500 hover:text-black hover:border-black transition-colors uppercase disabled:opacity-50 disabled:hover:border-gray-300",children:"Send"})]})})]})]})};var iA=e.i(59015);function iC(){let[e,t]=(0,e8.useState)("home"),n=(0,e9.useSearchParams)().get("targetId");return(0,e8.useEffect)(()=>{n&&setTimeout(()=>{let e=document.getElementById(n);e&&e.scrollIntoView({behavior:"smooth"})},100)},[n]),(0,e8.useEffect)(()=>{let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&t(e.target.id)})},{root:null,rootMargin:"-20% 0px -60% 0px",threshold:0}),n=document.querySelectorAll("section");return n.forEach(t=>e.observe(t)),()=>n.forEach(t=>e.unobserve(t))},[]),(0,e7.jsxs)(iA.Layout,{activeSection:e,children:[(0,e7.jsx)("section",{id:"home",className:"min-h-screen flex flex-col justify-center py-20 scroll-mt-20",children:(0,e7.jsx)(tr,{})}),(0,e7.jsx)("section",{id:"projects",className:"min-h-screen flex flex-col justify-center py-20 scroll-mt-20",children:(0,e7.jsx)(ts,{})}),(0,e7.jsx)("section",{id:"ai-uplink",className:"min-h-screen flex flex-col justify-center py-20 scroll-mt-20",children:(0,e7.jsx)(iT,{})})]})}function iS(){return(0,e7.jsx)(e8.Suspense,{fallback:(0,e7.jsx)("div",{children:"Loading..."}),children:(0,e7.jsx)(iC,{})})}e.s(["default",()=>iS],31713)}]);